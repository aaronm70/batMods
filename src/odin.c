// Automatically generated by odin - do not edit
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <stdbool.h>
#include <R_ext/Rdynload.h>
typedef struct detSEIR_internal {
  double beta_1;
  double betaFX;
  double betaFXVal;
  double betaVer;
  double birthType;
  double c;
  double c_Val;
  double c_val2;
  double cV;
  double dt;
  double Ef_ini;
  double Ej_ini;
  double Em_ini;
  double En_ini;
  double envOscType;
  double epsilon_Val;
  double gamma_1;
  double gamma_1_Val;
  double gamma_2_Val;
  double gammaVer;
  double If_ini;
  double Ij_ini;
  double Im_ini;
  double In_ini;
  double initial_Ef;
  double initial_Ej;
  double initial_Em;
  double initial_En;
  double initial_If;
  double initial_Ij;
  double initial_Im;
  double initial_In;
  double initial_Ma;
  double initial_R0_out;
  double initial_Rf;
  double initial_Rj;
  double initial_Rm;
  double initial_Rn;
  double initial_Sf;
  double initial_Sj;
  double initial_Sm;
  double initial_Sn;
  double initial_timeOsc;
  double kappa;
  double kappa_Val;
  double m;
  double m_Val;
  double Ma_ini;
  double mj;
  double mj_Val;
  double mu;
  double mu_Val;
  double omega_2_Val;
  double omega_m;
  double omega_m_Val;
  double phi;
  double phi_Val;
  double Phi2_val;
  double phiV;
  double R0_Val;
  double Rf_ini;
  double rho;
  double rho_Val;
  double Rj_ini;
  double Rm_ini;
  double Rn_ini;
  double s;
  double s_Val;
  double S2_val;
  double Sf_ini;
  double sigma_1;
  double sigma_2;
  double sigma_2_Val;
  double sigmaVer;
  double Sj_ini;
  double Sm_ini;
  double Sn_ini;
  double sV;
  double timeOscIni;
  double zeta_s;
} detSEIR_internal;
typedef struct stochSEIR_internal {
  int *B_ef;
  int *B_ej;
  int *B_em;
  int *B_en;
  int *B_if;
  int *B_ij;
  int *B_im;
  int *B_in;
  int *B_ma;
  int *B_rf;
  int *B_rj;
  int *B_rm;
  int *B_rn;
  int *B_sf;
  int *B_sj;
  int *B_sm;
  int *B_sn;
  double beta_1;
  double betaFX;
  double betaFXVal;
  double betaVer;
  double birthType;
  double c;
  double c_Val;
  double c_val2;
  double cV;
  int dim_B_ef;
  int dim_B_ej;
  int dim_B_em;
  int dim_B_en;
  int dim_B_if;
  int dim_B_ij;
  int dim_B_im;
  int dim_B_in;
  int dim_B_ma;
  int dim_B_rf;
  int dim_B_rj;
  int dim_B_rm;
  int dim_B_rn;
  int dim_B_sf;
  int dim_B_sj;
  int dim_B_sm;
  int dim_B_sn;
  int dim_p;
  int dim_p1;
  int dim_p2;
  int dim_p3;
  int dim_p4;
  int dim_pf;
  int dim_pf1;
  int dim_pf2;
  int dim_pf3;
  int dim_pj;
  int dim_pj1;
  int dim_pj2;
  int dim_pj3;
  int dim_pm;
  int dim_pm1;
  int dim_pm2;
  int dim_pm3;
  double dt;
  double Ef_ini;
  double Ej_ini;
  double Em_ini;
  double En_ini;
  double envOscType;
  double epsilon_Val;
  double gamma_1;
  double gamma_1_Val;
  double gamma_2_Val;
  double gammaVer;
  double If_ini;
  double Ij_ini;
  double Im_ini;
  double In_ini;
  double initial_Ef;
  double initial_Ej;
  double initial_Em;
  double initial_En;
  double initial_If;
  double initial_Ij;
  double initial_Im;
  double initial_In;
  double initial_Ma;
  double initial_R0_out;
  double initial_Rf;
  double initial_Rj;
  double initial_Rm;
  double initial_Rn;
  double initial_Sf;
  double initial_Sj;
  double initial_Sm;
  double initial_Sn;
  double initial_timeOsc;
  double kappa;
  double kappa_Val;
  double m;
  double m_Val;
  double Ma_ini;
  double mj;
  double mj_Val;
  double mu;
  double mu_Val;
  double n_Sf_Ef;
  double n_Sj_Ej;
  double n_Sm_Em;
  double n_Sn_En;
  double omega_2_Val;
  double omega_m;
  double omega_m_Val;
  double *p;
  double P_E_R;
  double P_E_S;
  double P_I_E;
  double P_I_S;
  double P_J_A;
  double P_matWane;
  double *p1;
  double *p2;
  double *p3;
  double *p4;
  double *pf;
  double *pf1;
  double *pf2;
  double *pf3;
  double phi;
  double phi_Val;
  double Phi2_val;
  double phiV;
  double *pj;
  double *pj1;
  double *pj2;
  double *pj3;
  double *pm;
  double *pm1;
  double *pm2;
  double *pm3;
  double R0_Val;
  double Rf_ini;
  double rho;
  double rho_Val;
  double Rj_ini;
  double Rm_ini;
  double Rn_ini;
  double s;
  double s_Val;
  double S2_val;
  double Sf_ini;
  double sigma_1;
  double sigma_2;
  double sigma_2_Val;
  double sigmaVer;
  double Sj_ini;
  double Sm_ini;
  double Sn_ini;
  double sV;
  double timeOscIni;
  double zeta_s;
} stochSEIR_internal;
typedef struct stochSEIRadInf_internal {
  int *B_ef;
  int *B_ej;
  int *B_em;
  int *B_en;
  int *B_if;
  int *B_im;
  int *B_ma;
  int *B_rf;
  int *B_rj;
  int *B_rm;
  int *B_rn;
  int *B_sf;
  int *B_sj;
  int *B_sm;
  int *B_sn;
  double betaVer;
  double c;
  double c_Val;
  int dim_B_ef;
  int dim_B_ej;
  int dim_B_em;
  int dim_B_en;
  int dim_B_if;
  int dim_B_im;
  int dim_B_ma;
  int dim_B_rf;
  int dim_B_rj;
  int dim_B_rm;
  int dim_B_rn;
  int dim_B_sf;
  int dim_B_sj;
  int dim_B_sm;
  int dim_B_sn;
  int dim_p;
  int dim_p1;
  int dim_p3;
  int dim_p4;
  int dim_pf;
  int dim_pf1;
  int dim_pf2;
  int dim_pf3;
  int dim_pj;
  int dim_pj1;
  int dim_pj3;
  int dim_pm;
  int dim_pm1;
  int dim_pm2;
  int dim_pm3;
  double dt;
  double Ef_ini;
  double Ej_ini;
  double Em_ini;
  double En_ini;
  double epsilon;
  double epsilon_Val;
  double gamma_1;
  double gamma_1_Val;
  double gamma_2;
  double gamma_2_Val;
  double gammaVer;
  double If_ini;
  double Im_ini;
  double initial_Ef;
  double initial_Ej;
  double initial_Em;
  double initial_En;
  double initial_If;
  double initial_Im;
  double initial_Ma;
  double initial_Rf;
  double initial_Rj;
  double initial_Rm;
  double initial_Rn;
  double initial_Sf;
  double initial_Sj;
  double initial_Sm;
  double initial_Sn;
  double initial_timeOsc;
  double kappa;
  double kappa_Val;
  double m;
  double m_Val;
  double Ma_ini;
  double mj;
  double mj_Val;
  double mu;
  double mu_Val;
  double omega_2;
  double omega_2_Val;
  double omega_m;
  double omega_m_Val;
  double *p;
  double P_E_I;
  double P_E_R;
  double P_E_S;
  double P_I_E;
  double P_I_R;
  double P_I_S;
  double P_ImWane;
  double P_J_A;
  double P_matWane;
  double *p1;
  double *p3;
  double *p4;
  double *pf;
  double *pf1;
  double *pf2;
  double *pf3;
  double phi;
  double phi_Val;
  double *pj;
  double *pj1;
  double *pj3;
  double *pm;
  double *pm1;
  double *pm2;
  double *pm3;
  double R0_Val;
  double Rf_ini;
  double rho;
  double rho_Val;
  double Rj_ini;
  double Rm_ini;
  double Rn_ini;
  double s;
  double s_Val;
  double Sf_ini;
  double sigma_1;
  double sigma_1_Val;
  double sigma_2;
  double sigma_2_Val;
  double sigmaVer;
  double Sj_ini;
  double Sm_ini;
  double Sn_ini;
} stochSEIRadInf_internal;
detSEIR_internal* detSEIR_get_internal(SEXP internal_p, int closed_error);
static void detSEIR_finalise(SEXP internal_p);
SEXP detSEIR_create(SEXP user);
void detSEIR_initmod_desolve(void(* odeparms) (int *, double *));
SEXP detSEIR_contents(SEXP internal_p);
SEXP detSEIR_set_user(SEXP internal_p, SEXP user);
SEXP detSEIR_metadata(SEXP internal_p);
SEXP detSEIR_initial_conditions(SEXP internal_p, SEXP step_ptr);
void detSEIR_rhs(detSEIR_internal* internal, size_t step, double * state, double * state_next, double * output);
void detSEIR_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP detSEIR_rhs_r(SEXP internal_p, SEXP step, SEXP state);
stochSEIR_internal* stochSEIR_get_internal(SEXP internal_p, int closed_error);
static void stochSEIR_finalise(SEXP internal_p);
SEXP stochSEIR_create(SEXP user);
void stochSEIR_initmod_desolve(void(* odeparms) (int *, double *));
SEXP stochSEIR_contents(SEXP internal_p);
SEXP stochSEIR_set_user(SEXP internal_p, SEXP user);
SEXP stochSEIR_metadata(SEXP internal_p);
SEXP stochSEIR_initial_conditions(SEXP internal_p, SEXP step_ptr);
void stochSEIR_rhs(stochSEIR_internal* internal, size_t step, double * state, double * state_next, double * output);
void stochSEIR_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP stochSEIR_rhs_r(SEXP internal_p, SEXP step, SEXP state);
stochSEIRadInf_internal* stochSEIRadInf_get_internal(SEXP internal_p, int closed_error);
static void stochSEIRadInf_finalise(SEXP internal_p);
SEXP stochSEIRadInf_create(SEXP user);
void stochSEIRadInf_initmod_desolve(void(* odeparms) (int *, double *));
SEXP stochSEIRadInf_contents(SEXP internal_p);
SEXP stochSEIRadInf_set_user(SEXP internal_p, SEXP user);
SEXP stochSEIRadInf_metadata(SEXP internal_p);
SEXP stochSEIRadInf_initial_conditions(SEXP internal_p, SEXP step_ptr);
void stochSEIRadInf_rhs(stochSEIRadInf_internal* internal, size_t step, double * state, double * state_next, double * output);
void stochSEIRadInf_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP stochSEIRadInf_rhs_r(SEXP internal_p, SEXP step, SEXP state);
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max);
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max);
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name);
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name);
void user_check_values(SEXP value, double min, double max,
                           const char *name);
SEXP user_list_element(SEXP list, const char *name);
detSEIR_internal* detSEIR_get_internal(SEXP internal_p, int closed_error) {
  detSEIR_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (detSEIR_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void detSEIR_finalise(SEXP internal_p) {
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 0);
  if (internal_p) {
    Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP detSEIR_create(SEXP user) {
  detSEIR_internal *internal = (detSEIR_internal*) Calloc(1, detSEIR_internal);
  internal->beta_1 = 0;
  internal->initial_R0_out = 0;
  internal->sigma_1 = 0;
  internal->betaFX = 0;
  internal->betaFXVal = 0;
  internal->betaVer = 0;
  internal->birthType = 0;
  internal->c_Val = 1.53;
  internal->c_val2 = 0;
  internal->dt = 365;
  internal->Ef_ini = 5;
  internal->Ej_ini = 5;
  internal->Em_ini = 5;
  internal->En_ini = 5;
  internal->envOscType = 0;
  internal->epsilon_Val = 0.90000000000000002;
  internal->gamma_1_Val = 0.80000000000000004;
  internal->gamma_2_Val = 0;
  internal->gammaVer = 0;
  internal->If_ini = 0;
  internal->Ij_ini = 0;
  internal->Im_ini = 0;
  internal->In_ini = 0;
  internal->kappa_Val = 1000;
  internal->m_Val = 0.186;
  internal->Ma_ini = 0;
  internal->mj_Val = 0.79600000000000004;
  internal->mu_Val = 0.44;
  internal->omega_2_Val = 0.40000000000000002;
  internal->omega_m_Val = 0.40000000000000002;
  internal->phi_Val = 4.5;
  internal->Phi2_val = 0;
  internal->R0_Val = 0.5;
  internal->Rf_ini = 0;
  internal->rho_Val = 0.90000000000000002;
  internal->Rj_ini = 0;
  internal->Rm_ini = 0;
  internal->Rn_ini = 0;
  internal->s_Val = 14.300000000000001;
  internal->S2_val = 0;
  internal->Sf_ini = 20;
  internal->sigma_2_Val = 0;
  internal->sigmaVer = 0;
  internal->Sj_ini = 20;
  internal->Sm_ini = 20;
  internal->Sn_ini = 20;
  internal->timeOscIni = 0;
  internal->zeta_s = 0.80000000000000004;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, detSEIR_finalise);
  UNPROTECT(1);
  return ptr;
}
static detSEIR_internal *detSEIR_internal_ds;
void detSEIR_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  detSEIR_internal_ds = detSEIR_get_internal(get_desolve_gparms(), 1);
}
SEXP detSEIR_contents(SEXP internal_p) {
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 80));
  SET_VECTOR_ELT(contents, 0, ScalarReal(internal->beta_1));
  SET_VECTOR_ELT(contents, 1, ScalarReal(internal->betaFX));
  SET_VECTOR_ELT(contents, 2, ScalarReal(internal->betaFXVal));
  SET_VECTOR_ELT(contents, 3, ScalarReal(internal->betaVer));
  SET_VECTOR_ELT(contents, 4, ScalarReal(internal->birthType));
  SET_VECTOR_ELT(contents, 5, ScalarReal(internal->c));
  SET_VECTOR_ELT(contents, 6, ScalarReal(internal->c_Val));
  SET_VECTOR_ELT(contents, 7, ScalarReal(internal->c_val2));
  SET_VECTOR_ELT(contents, 8, ScalarReal(internal->cV));
  SET_VECTOR_ELT(contents, 9, ScalarReal(internal->dt));
  SET_VECTOR_ELT(contents, 10, ScalarReal(internal->Ef_ini));
  SET_VECTOR_ELT(contents, 11, ScalarReal(internal->Ej_ini));
  SET_VECTOR_ELT(contents, 12, ScalarReal(internal->Em_ini));
  SET_VECTOR_ELT(contents, 13, ScalarReal(internal->En_ini));
  SET_VECTOR_ELT(contents, 14, ScalarReal(internal->envOscType));
  SET_VECTOR_ELT(contents, 15, ScalarReal(internal->epsilon_Val));
  SET_VECTOR_ELT(contents, 16, ScalarReal(internal->gamma_1));
  SET_VECTOR_ELT(contents, 17, ScalarReal(internal->gamma_1_Val));
  SET_VECTOR_ELT(contents, 18, ScalarReal(internal->gamma_2_Val));
  SET_VECTOR_ELT(contents, 19, ScalarReal(internal->gammaVer));
  SET_VECTOR_ELT(contents, 20, ScalarReal(internal->If_ini));
  SET_VECTOR_ELT(contents, 21, ScalarReal(internal->Ij_ini));
  SET_VECTOR_ELT(contents, 22, ScalarReal(internal->Im_ini));
  SET_VECTOR_ELT(contents, 23, ScalarReal(internal->In_ini));
  SET_VECTOR_ELT(contents, 24, ScalarReal(internal->initial_Ef));
  SET_VECTOR_ELT(contents, 25, ScalarReal(internal->initial_Ej));
  SET_VECTOR_ELT(contents, 26, ScalarReal(internal->initial_Em));
  SET_VECTOR_ELT(contents, 27, ScalarReal(internal->initial_En));
  SET_VECTOR_ELT(contents, 28, ScalarReal(internal->initial_If));
  SET_VECTOR_ELT(contents, 29, ScalarReal(internal->initial_Ij));
  SET_VECTOR_ELT(contents, 30, ScalarReal(internal->initial_Im));
  SET_VECTOR_ELT(contents, 31, ScalarReal(internal->initial_In));
  SET_VECTOR_ELT(contents, 32, ScalarReal(internal->initial_Ma));
  SET_VECTOR_ELT(contents, 33, ScalarReal(internal->initial_R0_out));
  SET_VECTOR_ELT(contents, 34, ScalarReal(internal->initial_Rf));
  SET_VECTOR_ELT(contents, 35, ScalarReal(internal->initial_Rj));
  SET_VECTOR_ELT(contents, 36, ScalarReal(internal->initial_Rm));
  SET_VECTOR_ELT(contents, 37, ScalarReal(internal->initial_Rn));
  SET_VECTOR_ELT(contents, 38, ScalarReal(internal->initial_Sf));
  SET_VECTOR_ELT(contents, 39, ScalarReal(internal->initial_Sj));
  SET_VECTOR_ELT(contents, 40, ScalarReal(internal->initial_Sm));
  SET_VECTOR_ELT(contents, 41, ScalarReal(internal->initial_Sn));
  SET_VECTOR_ELT(contents, 42, ScalarReal(internal->initial_timeOsc));
  SET_VECTOR_ELT(contents, 43, ScalarReal(internal->kappa));
  SET_VECTOR_ELT(contents, 44, ScalarReal(internal->kappa_Val));
  SET_VECTOR_ELT(contents, 45, ScalarReal(internal->m));
  SET_VECTOR_ELT(contents, 46, ScalarReal(internal->m_Val));
  SET_VECTOR_ELT(contents, 47, ScalarReal(internal->Ma_ini));
  SET_VECTOR_ELT(contents, 48, ScalarReal(internal->mj));
  SET_VECTOR_ELT(contents, 49, ScalarReal(internal->mj_Val));
  SET_VECTOR_ELT(contents, 50, ScalarReal(internal->mu));
  SET_VECTOR_ELT(contents, 51, ScalarReal(internal->mu_Val));
  SET_VECTOR_ELT(contents, 52, ScalarReal(internal->omega_2_Val));
  SET_VECTOR_ELT(contents, 53, ScalarReal(internal->omega_m));
  SET_VECTOR_ELT(contents, 54, ScalarReal(internal->omega_m_Val));
  SET_VECTOR_ELT(contents, 55, ScalarReal(internal->phi));
  SET_VECTOR_ELT(contents, 56, ScalarReal(internal->phi_Val));
  SET_VECTOR_ELT(contents, 57, ScalarReal(internal->Phi2_val));
  SET_VECTOR_ELT(contents, 58, ScalarReal(internal->phiV));
  SET_VECTOR_ELT(contents, 59, ScalarReal(internal->R0_Val));
  SET_VECTOR_ELT(contents, 60, ScalarReal(internal->Rf_ini));
  SET_VECTOR_ELT(contents, 61, ScalarReal(internal->rho));
  SET_VECTOR_ELT(contents, 62, ScalarReal(internal->rho_Val));
  SET_VECTOR_ELT(contents, 63, ScalarReal(internal->Rj_ini));
  SET_VECTOR_ELT(contents, 64, ScalarReal(internal->Rm_ini));
  SET_VECTOR_ELT(contents, 65, ScalarReal(internal->Rn_ini));
  SET_VECTOR_ELT(contents, 66, ScalarReal(internal->s));
  SET_VECTOR_ELT(contents, 67, ScalarReal(internal->s_Val));
  SET_VECTOR_ELT(contents, 68, ScalarReal(internal->S2_val));
  SET_VECTOR_ELT(contents, 69, ScalarReal(internal->Sf_ini));
  SET_VECTOR_ELT(contents, 70, ScalarReal(internal->sigma_1));
  SET_VECTOR_ELT(contents, 71, ScalarReal(internal->sigma_2));
  SET_VECTOR_ELT(contents, 72, ScalarReal(internal->sigma_2_Val));
  SET_VECTOR_ELT(contents, 73, ScalarReal(internal->sigmaVer));
  SET_VECTOR_ELT(contents, 74, ScalarReal(internal->Sj_ini));
  SET_VECTOR_ELT(contents, 75, ScalarReal(internal->Sm_ini));
  SET_VECTOR_ELT(contents, 76, ScalarReal(internal->Sn_ini));
  SET_VECTOR_ELT(contents, 77, ScalarReal(internal->sV));
  SET_VECTOR_ELT(contents, 78, ScalarReal(internal->timeOscIni));
  SET_VECTOR_ELT(contents, 79, ScalarReal(internal->zeta_s));
  SEXP nms = PROTECT(allocVector(STRSXP, 80));
  SET_STRING_ELT(nms, 0, mkChar("beta_1"));
  SET_STRING_ELT(nms, 1, mkChar("betaFX"));
  SET_STRING_ELT(nms, 2, mkChar("betaFXVal"));
  SET_STRING_ELT(nms, 3, mkChar("betaVer"));
  SET_STRING_ELT(nms, 4, mkChar("birthType"));
  SET_STRING_ELT(nms, 5, mkChar("c"));
  SET_STRING_ELT(nms, 6, mkChar("c_Val"));
  SET_STRING_ELT(nms, 7, mkChar("c_val2"));
  SET_STRING_ELT(nms, 8, mkChar("cV"));
  SET_STRING_ELT(nms, 9, mkChar("dt"));
  SET_STRING_ELT(nms, 10, mkChar("Ef_ini"));
  SET_STRING_ELT(nms, 11, mkChar("Ej_ini"));
  SET_STRING_ELT(nms, 12, mkChar("Em_ini"));
  SET_STRING_ELT(nms, 13, mkChar("En_ini"));
  SET_STRING_ELT(nms, 14, mkChar("envOscType"));
  SET_STRING_ELT(nms, 15, mkChar("epsilon_Val"));
  SET_STRING_ELT(nms, 16, mkChar("gamma_1"));
  SET_STRING_ELT(nms, 17, mkChar("gamma_1_Val"));
  SET_STRING_ELT(nms, 18, mkChar("gamma_2_Val"));
  SET_STRING_ELT(nms, 19, mkChar("gammaVer"));
  SET_STRING_ELT(nms, 20, mkChar("If_ini"));
  SET_STRING_ELT(nms, 21, mkChar("Ij_ini"));
  SET_STRING_ELT(nms, 22, mkChar("Im_ini"));
  SET_STRING_ELT(nms, 23, mkChar("In_ini"));
  SET_STRING_ELT(nms, 24, mkChar("initial_Ef"));
  SET_STRING_ELT(nms, 25, mkChar("initial_Ej"));
  SET_STRING_ELT(nms, 26, mkChar("initial_Em"));
  SET_STRING_ELT(nms, 27, mkChar("initial_En"));
  SET_STRING_ELT(nms, 28, mkChar("initial_If"));
  SET_STRING_ELT(nms, 29, mkChar("initial_Ij"));
  SET_STRING_ELT(nms, 30, mkChar("initial_Im"));
  SET_STRING_ELT(nms, 31, mkChar("initial_In"));
  SET_STRING_ELT(nms, 32, mkChar("initial_Ma"));
  SET_STRING_ELT(nms, 33, mkChar("initial_R0_out"));
  SET_STRING_ELT(nms, 34, mkChar("initial_Rf"));
  SET_STRING_ELT(nms, 35, mkChar("initial_Rj"));
  SET_STRING_ELT(nms, 36, mkChar("initial_Rm"));
  SET_STRING_ELT(nms, 37, mkChar("initial_Rn"));
  SET_STRING_ELT(nms, 38, mkChar("initial_Sf"));
  SET_STRING_ELT(nms, 39, mkChar("initial_Sj"));
  SET_STRING_ELT(nms, 40, mkChar("initial_Sm"));
  SET_STRING_ELT(nms, 41, mkChar("initial_Sn"));
  SET_STRING_ELT(nms, 42, mkChar("initial_timeOsc"));
  SET_STRING_ELT(nms, 43, mkChar("kappa"));
  SET_STRING_ELT(nms, 44, mkChar("kappa_Val"));
  SET_STRING_ELT(nms, 45, mkChar("m"));
  SET_STRING_ELT(nms, 46, mkChar("m_Val"));
  SET_STRING_ELT(nms, 47, mkChar("Ma_ini"));
  SET_STRING_ELT(nms, 48, mkChar("mj"));
  SET_STRING_ELT(nms, 49, mkChar("mj_Val"));
  SET_STRING_ELT(nms, 50, mkChar("mu"));
  SET_STRING_ELT(nms, 51, mkChar("mu_Val"));
  SET_STRING_ELT(nms, 52, mkChar("omega_2_Val"));
  SET_STRING_ELT(nms, 53, mkChar("omega_m"));
  SET_STRING_ELT(nms, 54, mkChar("omega_m_Val"));
  SET_STRING_ELT(nms, 55, mkChar("phi"));
  SET_STRING_ELT(nms, 56, mkChar("phi_Val"));
  SET_STRING_ELT(nms, 57, mkChar("Phi2_val"));
  SET_STRING_ELT(nms, 58, mkChar("phiV"));
  SET_STRING_ELT(nms, 59, mkChar("R0_Val"));
  SET_STRING_ELT(nms, 60, mkChar("Rf_ini"));
  SET_STRING_ELT(nms, 61, mkChar("rho"));
  SET_STRING_ELT(nms, 62, mkChar("rho_Val"));
  SET_STRING_ELT(nms, 63, mkChar("Rj_ini"));
  SET_STRING_ELT(nms, 64, mkChar("Rm_ini"));
  SET_STRING_ELT(nms, 65, mkChar("Rn_ini"));
  SET_STRING_ELT(nms, 66, mkChar("s"));
  SET_STRING_ELT(nms, 67, mkChar("s_Val"));
  SET_STRING_ELT(nms, 68, mkChar("S2_val"));
  SET_STRING_ELT(nms, 69, mkChar("Sf_ini"));
  SET_STRING_ELT(nms, 70, mkChar("sigma_1"));
  SET_STRING_ELT(nms, 71, mkChar("sigma_2"));
  SET_STRING_ELT(nms, 72, mkChar("sigma_2_Val"));
  SET_STRING_ELT(nms, 73, mkChar("sigmaVer"));
  SET_STRING_ELT(nms, 74, mkChar("Sj_ini"));
  SET_STRING_ELT(nms, 75, mkChar("Sm_ini"));
  SET_STRING_ELT(nms, 76, mkChar("Sn_ini"));
  SET_STRING_ELT(nms, 77, mkChar("sV"));
  SET_STRING_ELT(nms, 78, mkChar("timeOscIni"));
  SET_STRING_ELT(nms, 79, mkChar("zeta_s"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(2);
  return contents;
}
SEXP detSEIR_set_user(SEXP internal_p, SEXP user) {
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 1);
  internal->betaFX = user_get_scalar_double(user, "betaFX", internal->betaFX, NA_REAL, NA_REAL);
  internal->betaFXVal = user_get_scalar_double(user, "betaFXVal", internal->betaFXVal, NA_REAL, NA_REAL);
  internal->betaVer = user_get_scalar_double(user, "betaVer", internal->betaVer, NA_REAL, NA_REAL);
  internal->birthType = user_get_scalar_double(user, "birthType", internal->birthType, NA_REAL, NA_REAL);
  internal->c_Val = user_get_scalar_double(user, "c_Val", internal->c_Val, NA_REAL, NA_REAL);
  internal->c_val2 = user_get_scalar_double(user, "c_val2", internal->c_val2, NA_REAL, NA_REAL);
  internal->dt = user_get_scalar_double(user, "dt", internal->dt, NA_REAL, NA_REAL);
  internal->Ef_ini = user_get_scalar_double(user, "Ef_ini", internal->Ef_ini, NA_REAL, NA_REAL);
  internal->Ej_ini = user_get_scalar_double(user, "Ej_ini", internal->Ej_ini, NA_REAL, NA_REAL);
  internal->Em_ini = user_get_scalar_double(user, "Em_ini", internal->Em_ini, NA_REAL, NA_REAL);
  internal->En_ini = user_get_scalar_double(user, "En_ini", internal->En_ini, NA_REAL, NA_REAL);
  internal->envOscType = user_get_scalar_double(user, "envOscType", internal->envOscType, NA_REAL, NA_REAL);
  internal->epsilon_Val = user_get_scalar_double(user, "epsilon_Val", internal->epsilon_Val, NA_REAL, NA_REAL);
  internal->gamma_1_Val = user_get_scalar_double(user, "gamma_1_Val", internal->gamma_1_Val, NA_REAL, NA_REAL);
  internal->gamma_2_Val = user_get_scalar_double(user, "gamma_2_Val", internal->gamma_2_Val, NA_REAL, NA_REAL);
  internal->gammaVer = user_get_scalar_double(user, "gammaVer", internal->gammaVer, NA_REAL, NA_REAL);
  internal->If_ini = user_get_scalar_double(user, "If_ini", internal->If_ini, NA_REAL, NA_REAL);
  internal->Ij_ini = user_get_scalar_double(user, "Ij_ini", internal->Ij_ini, NA_REAL, NA_REAL);
  internal->Im_ini = user_get_scalar_double(user, "Im_ini", internal->Im_ini, NA_REAL, NA_REAL);
  internal->In_ini = user_get_scalar_double(user, "In_ini", internal->In_ini, NA_REAL, NA_REAL);
  internal->kappa_Val = user_get_scalar_double(user, "kappa_Val", internal->kappa_Val, NA_REAL, NA_REAL);
  internal->m_Val = user_get_scalar_double(user, "m_Val", internal->m_Val, NA_REAL, NA_REAL);
  internal->Ma_ini = user_get_scalar_double(user, "Ma_ini", internal->Ma_ini, NA_REAL, NA_REAL);
  internal->mj_Val = user_get_scalar_double(user, "mj_Val", internal->mj_Val, NA_REAL, NA_REAL);
  internal->mu_Val = user_get_scalar_double(user, "mu_Val", internal->mu_Val, NA_REAL, NA_REAL);
  internal->omega_2_Val = user_get_scalar_double(user, "omega_2_Val", internal->omega_2_Val, NA_REAL, NA_REAL);
  internal->omega_m_Val = user_get_scalar_double(user, "omega_m_Val", internal->omega_m_Val, NA_REAL, NA_REAL);
  internal->phi_Val = user_get_scalar_double(user, "phi_Val", internal->phi_Val, NA_REAL, NA_REAL);
  internal->Phi2_val = user_get_scalar_double(user, "Phi2_val", internal->Phi2_val, NA_REAL, NA_REAL);
  internal->R0_Val = user_get_scalar_double(user, "R0_Val", internal->R0_Val, NA_REAL, NA_REAL);
  internal->Rf_ini = user_get_scalar_double(user, "Rf_ini", internal->Rf_ini, NA_REAL, NA_REAL);
  internal->rho_Val = user_get_scalar_double(user, "rho_Val", internal->rho_Val, NA_REAL, NA_REAL);
  internal->Rj_ini = user_get_scalar_double(user, "Rj_ini", internal->Rj_ini, NA_REAL, NA_REAL);
  internal->Rm_ini = user_get_scalar_double(user, "Rm_ini", internal->Rm_ini, NA_REAL, NA_REAL);
  internal->Rn_ini = user_get_scalar_double(user, "Rn_ini", internal->Rn_ini, NA_REAL, NA_REAL);
  internal->s_Val = user_get_scalar_double(user, "s_Val", internal->s_Val, NA_REAL, NA_REAL);
  internal->S2_val = user_get_scalar_double(user, "S2_val", internal->S2_val, NA_REAL, NA_REAL);
  internal->Sf_ini = user_get_scalar_double(user, "Sf_ini", internal->Sf_ini, NA_REAL, NA_REAL);
  internal->sigma_2_Val = user_get_scalar_double(user, "sigma_2_Val", internal->sigma_2_Val, NA_REAL, NA_REAL);
  internal->sigmaVer = user_get_scalar_double(user, "sigmaVer", internal->sigmaVer, NA_REAL, NA_REAL);
  internal->Sj_ini = user_get_scalar_double(user, "Sj_ini", internal->Sj_ini, NA_REAL, NA_REAL);
  internal->Sm_ini = user_get_scalar_double(user, "Sm_ini", internal->Sm_ini, NA_REAL, NA_REAL);
  internal->Sn_ini = user_get_scalar_double(user, "Sn_ini", internal->Sn_ini, NA_REAL, NA_REAL);
  internal->timeOscIni = user_get_scalar_double(user, "timeOscIni", internal->timeOscIni, NA_REAL, NA_REAL);
  internal->zeta_s = user_get_scalar_double(user, "zeta_s", internal->zeta_s, NA_REAL, NA_REAL);
  internal->c = internal->c_Val;
  internal->cV = internal->c_val2;
  internal->gamma_1 = (internal->gammaVer == 1 ? internal->gamma_1_Val / (double) internal->dt : 0);
  internal->initial_Ef = internal->Ef_ini;
  internal->initial_Ej = internal->Ej_ini;
  internal->initial_Em = internal->Em_ini;
  internal->initial_En = internal->En_ini;
  internal->initial_If = internal->If_ini;
  internal->initial_Ij = internal->Ij_ini;
  internal->initial_Im = internal->Im_ini;
  internal->initial_In = internal->In_ini;
  internal->initial_Ma = internal->Ma_ini;
  internal->initial_Rf = internal->Rf_ini;
  internal->initial_Rj = internal->Rj_ini;
  internal->initial_Rm = internal->Rm_ini;
  internal->initial_Rn = internal->Rn_ini;
  internal->initial_Sf = internal->Sf_ini;
  internal->initial_Sj = internal->Sj_ini;
  internal->initial_Sm = internal->Sm_ini;
  internal->initial_Sn = internal->Sn_ini;
  internal->initial_timeOsc = internal->timeOscIni;
  internal->kappa = internal->kappa_Val;
  internal->m = internal->m_Val / (double) internal->dt;
  internal->mj = internal->mj_Val / (double) internal->dt;
  internal->mu = internal->mu_Val / (double) internal->dt;
  internal->omega_m = internal->omega_m_Val / (double) internal->dt;
  internal->phi = internal->phi_Val;
  internal->phiV = internal->Phi2_val;
  internal->rho = internal->rho_Val / (double) internal->dt;
  internal->s = internal->s_Val;
  internal->sigma_2 = (internal->sigmaVer == 2 ? internal->sigma_2_Val / (double) internal->dt : 0);
  internal->sV = internal->S2_val;
  return R_NilValue;
}
SEXP detSEIR_metadata(SEXP internal_p) {
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 19));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 19));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, R_NilValue);
  SET_VECTOR_ELT(variable_length, 1, R_NilValue);
  SET_VECTOR_ELT(variable_length, 2, R_NilValue);
  SET_VECTOR_ELT(variable_length, 3, R_NilValue);
  SET_VECTOR_ELT(variable_length, 4, R_NilValue);
  SET_VECTOR_ELT(variable_length, 5, R_NilValue);
  SET_VECTOR_ELT(variable_length, 6, R_NilValue);
  SET_VECTOR_ELT(variable_length, 7, R_NilValue);
  SET_VECTOR_ELT(variable_length, 8, R_NilValue);
  SET_VECTOR_ELT(variable_length, 9, R_NilValue);
  SET_VECTOR_ELT(variable_length, 10, R_NilValue);
  SET_VECTOR_ELT(variable_length, 11, R_NilValue);
  SET_VECTOR_ELT(variable_length, 12, R_NilValue);
  SET_VECTOR_ELT(variable_length, 13, R_NilValue);
  SET_VECTOR_ELT(variable_length, 14, R_NilValue);
  SET_VECTOR_ELT(variable_length, 15, R_NilValue);
  SET_VECTOR_ELT(variable_length, 16, R_NilValue);
  SET_VECTOR_ELT(variable_length, 17, R_NilValue);
  SET_VECTOR_ELT(variable_length, 18, R_NilValue);
  SET_STRING_ELT(variable_names, 0, mkChar("Sn"));
  SET_STRING_ELT(variable_names, 1, mkChar("Sj"));
  SET_STRING_ELT(variable_names, 2, mkChar("Sm"));
  SET_STRING_ELT(variable_names, 3, mkChar("Sf"));
  SET_STRING_ELT(variable_names, 4, mkChar("Ma"));
  SET_STRING_ELT(variable_names, 5, mkChar("En"));
  SET_STRING_ELT(variable_names, 6, mkChar("Ej"));
  SET_STRING_ELT(variable_names, 7, mkChar("Em"));
  SET_STRING_ELT(variable_names, 8, mkChar("Ef"));
  SET_STRING_ELT(variable_names, 9, mkChar("In"));
  SET_STRING_ELT(variable_names, 10, mkChar("Ij"));
  SET_STRING_ELT(variable_names, 11, mkChar("Im"));
  SET_STRING_ELT(variable_names, 12, mkChar("If"));
  SET_STRING_ELT(variable_names, 13, mkChar("Rn"));
  SET_STRING_ELT(variable_names, 14, mkChar("Rj"));
  SET_STRING_ELT(variable_names, 15, mkChar("Rm"));
  SET_STRING_ELT(variable_names, 16, mkChar("Rf"));
  SET_STRING_ELT(variable_names, 17, mkChar("timeOsc"));
  SET_STRING_ELT(variable_names, 18, mkChar("R0_out"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  UNPROTECT(2);
  return ret;
}
SEXP detSEIR_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, 19));
  double * state = REAL(r_state);
  state[0] = internal->initial_Sn;
  state[1] = internal->initial_Sj;
  state[2] = internal->initial_Sm;
  state[3] = internal->initial_Sf;
  state[4] = internal->initial_Ma;
  state[5] = internal->initial_En;
  state[6] = internal->initial_Ej;
  state[7] = internal->initial_Em;
  state[8] = internal->initial_Ef;
  state[9] = internal->initial_In;
  state[10] = internal->initial_Ij;
  state[11] = internal->initial_Im;
  state[12] = internal->initial_If;
  state[13] = internal->initial_Rn;
  state[14] = internal->initial_Rj;
  state[15] = internal->initial_Rm;
  state[16] = internal->initial_Rf;
  state[17] = internal->initial_timeOsc;
  state[18] = internal->initial_R0_out;
  UNPROTECT(1);
  return r_state;
}
void detSEIR_rhs(detSEIR_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double timeOsc = state[17];
  double Sn = state[0];
  double En = state[5];
  double In = state[9];
  double Rn = state[13];
  double Ma = state[4];
  double Sj = state[1];
  double Ej = state[6];
  double Ij = state[10];
  double Rj = state[14];
  double Sm = state[2];
  double Em = state[7];
  double Im = state[11];
  double Rm = state[15];
  double Sf = state[3];
  double Ef = state[8];
  double If = state[12];
  double Rf = state[16];
  double betE = internal->beta_1 * (If + Im + In + Ij);
  double N = (Sn + Sj + Sm + Sf + En + Ej + Em + Ef + In + Ij + Im + If + Rn + Rj + Rm + Rf + Ma);
  state_next[17] = timeOsc + 1 / (double) internal->dt;
  double b = internal->c * exp(-(internal->s) * pow((cos(3.1415929999999999 * timeOsc - internal->phi)), 2));
  double sDrive = (internal->envOscType == 1 ? internal->cV * exp(-(internal->sV) * pow((cos(3.1415929999999999 * timeOsc - internal->phiV)), 2)) : 1);
  state_next[18] = internal->R0_Val * ((Sn + Sj + Sf + Sm) / (double) N);
  double epsilon_ValS = (internal->epsilon_Val > 0 ? internal->epsilon_Val * sDrive : internal->epsilon_Val);
  double gamma_2_ValS = (internal->betaVer == 1 ? (internal->gamma_2_Val * sDrive) : internal->gamma_2_Val);
  double MaBirths = (internal->birthType == 1 ? (b * (Rf)) / (double) internal->dt : (b * (Rf + Ef)) / (double) internal->dt);
  double omega_2 = (internal->omega_2_Val > 0 ? (internal->omega_2_Val * sDrive) / (double) internal->dt : internal->omega_2_Val / (double) internal->dt);
  double Sbirths = (internal->birthType == 1 ? (b * (Sf + If + Ef)) / (double) internal->dt : (b * (Sf + If)) / (double) internal->dt);
  double beta_2x = (internal->betaFX == 0 ? internal->R0_Val * ((epsilon_ValS + internal->sigma_2_Val + internal->m_Val) * (gamma_2_ValS + internal->m_Val + internal->rho_Val) - epsilon_ValS * internal->rho_Val) / (double) (N * (epsilon_ValS + internal->sigma_2_Val + internal->m_Val)) : internal->betaFXVal);
  double epsilon = epsilon_ValS / (double) internal->dt;
  double gamma_2 = (internal->gammaVer == 2 ? gamma_2_ValS / (double) internal->dt : 0);
  state_next[4] = (Ma + (MaBirths) - (internal->omega_m + internal->mj * (N / (double) internal->kappa)) * Ma <= 0 ? 0 : Ma + (MaBirths) - (internal->omega_m + internal->mj * (N / (double) internal->kappa)) * Ma);
  double beta_2 = beta_2x / (double) internal->dt;
  state_next[8] = (Ef + internal->mu * (Ej / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Ef + (betE * Sf) + internal->rho * If <= 0 ? 0 : Ef + internal->mu * (Ej / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Ef + (betE * Sf) + internal->rho * If);
  state_next[6] = (Ej + internal->omega_m * En - (internal->mu + internal->mj * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Ej + betE * Sj + internal->rho * Ij <= 0 ? 0 : Ej + internal->omega_m * En - (internal->mu + internal->mj * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Ej + betE * Sj + internal->rho * Ij);
  state_next[7] = (Em + internal->mu * (Ej / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Em + betE * Sm + internal->rho * Im <= 0 ? 0 : Em + internal->mu * (Ej / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * Em + betE * Sm + internal->rho * Im);
  state_next[5] = (En - ((internal->omega_m + internal->mj * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * En) + betE * Sn + internal->rho * In <= 0 ? 0 : En - ((internal->omega_m + internal->mj * (N / (double) internal->kappa) + internal->sigma_1 + internal->sigma_2 + epsilon) * En) + betE * Sn + internal->rho * In);
  state_next[16] = (Rf + internal->mu * (Rj / (double) 2) - (internal->m * (N / (double) internal->kappa) + omega_2) * Rf + internal->sigma_2 * Ef + gamma_2 * If <= 0 ? 0 : Rf + internal->mu * (Rj / (double) 2) - (internal->m * (N / (double) internal->kappa) + omega_2) * Rf + internal->sigma_2 * Ef + gamma_2 * If);
  state_next[14] = (Rj + internal->omega_m * Rn - (internal->mu + internal->mj * (N / (double) internal->kappa) + omega_2) * Rj + internal->sigma_2 * Ej + gamma_2 * Ij <= 0 ? 0 : Rj + internal->omega_m * Rn - (internal->mu + internal->mj * (N / (double) internal->kappa) + omega_2) * Rj + internal->sigma_2 * Ej + gamma_2 * Ij);
  state_next[15] = (Rm + internal->mu * (Rj / (double) 2) - (internal->m * (N / (double) internal->kappa) + omega_2) * Rm + internal->sigma_2 * Em + gamma_2 * Im <= 0 ? 0 : Rm + internal->mu * (Rj / (double) 2) - (internal->m * (N / (double) internal->kappa) + omega_2) * Rm + internal->sigma_2 * Em + gamma_2 * Im);
  state_next[13] = (Rn - (internal->omega_m + internal->mj * (N / (double) internal->kappa) + omega_2) * Rn + internal->sigma_2 * En + gamma_2 * In <= 0 ? 0 : Rn - (internal->omega_m + internal->mj * (N / (double) internal->kappa) + omega_2) * Rn + internal->sigma_2 * En + gamma_2 * In);
  double betI = beta_2 * (If + Im + In + Ij);
  double betSj = internal->mu + internal->mj * (N / (double) internal->kappa) + (internal->beta_1 + beta_2) * (If + Im + In + Ij);
  double betSmf = internal->m * (N / (double) internal->kappa) + (internal->beta_1 + beta_2) * (If + Im + In + Ij);
  double betSN = internal->omega_m + internal->mj * (N / (double) internal->kappa) + ((internal->beta_1 + beta_2) * (If + Im + Ij + In));
  state_next[12] = (If + internal->mu * (Ij / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * If + (betI * Sf) + epsilon * Ef <= 0 ? 0 : If + internal->mu * (Ij / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * If + (betI * Sf) + epsilon * Ef);
  state_next[10] = (Ij + internal->omega_m * In - (internal->mu + internal->mj * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * Ij + betI * Sj + epsilon * Ej <= 0 ? 0 : Ij + internal->omega_m * In - (internal->mu + internal->mj * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * Ij + betI * Sj + epsilon * Ej);
  state_next[11] = (Im + internal->mu * (Ij / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * Im + (betI * Sm) + epsilon * Em <= 0 ? 0 : Im + internal->mu * (Ij / (double) 2) - (internal->m * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * Im + (betI * Sm) + epsilon * Em);
  state_next[9] = (In - ((internal->omega_m + internal->mj * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * In) + (betI * Sn) + epsilon * En <= 0 ? 0 : In - ((internal->omega_m + internal->mj * (N / (double) internal->kappa) + internal->gamma_1 + gamma_2 + internal->rho) * In) + (betI * Sn) + epsilon * En);
  state_next[3] = (Sf + internal->mu * (Sj / (double) 2) - betSmf * Sf + internal->sigma_1 * Ef + internal->gamma_1 * If + omega_2 * Rf <= 0 ? 0 : Sf + internal->mu * (Sj / (double) 2) - betSmf * Sf + internal->sigma_1 * Ef + internal->gamma_1 * If + omega_2 * Rf);
  state_next[1] = (Sj + internal->omega_m * (Sn + Ma) - betSj * Sj + internal->sigma_1 * Ej + internal->gamma_1 * Ij + omega_2 * Rj <= 0 ? 0 : Sj + internal->omega_m * (Sn + Ma) - betSj * Sj + internal->sigma_1 * Ej + internal->gamma_1 * Ij + omega_2 * Rj);
  state_next[2] = (Sm + internal->mu * (Sj / (double) 2) - betSmf * Sm + internal->sigma_1 * Em + internal->gamma_1 * Im + omega_2 * Rm <= 0 ? 0 : Sm + internal->mu * (Sj / (double) 2) - betSmf * Sm + internal->sigma_1 * Em + internal->gamma_1 * Im + omega_2 * Rm);
  state_next[0] = (Sn + (Sbirths) - (betSN * Sn) + internal->sigma_1 * En + internal->gamma_1 * In + omega_2 * Rn <= 0 ? 0 : Sn + (Sbirths) - (betSN * Sn) + internal->sigma_1 * En + internal->gamma_1 * In + omega_2 * Rn);
}
void detSEIR_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  detSEIR_rhs((detSEIR_internal*)internal, step, state, state_next, output);
}
SEXP detSEIR_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  detSEIR_internal *internal = detSEIR_get_internal(internal_p, 1);
  double *output = NULL;
  detSEIR_rhs(internal, INTEGER(step)[0], REAL(state), REAL(state_next), output);
  UNPROTECT(1);
  return state_next;
}
stochSEIR_internal* stochSEIR_get_internal(SEXP internal_p, int closed_error) {
  stochSEIR_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (stochSEIR_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void stochSEIR_finalise(SEXP internal_p) {
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 0);
  if (internal_p) {
    Free(internal->B_ef);
    Free(internal->B_ej);
    Free(internal->B_em);
    Free(internal->B_en);
    Free(internal->B_if);
    Free(internal->B_ij);
    Free(internal->B_im);
    Free(internal->B_in);
    Free(internal->B_ma);
    Free(internal->B_rf);
    Free(internal->B_rj);
    Free(internal->B_rm);
    Free(internal->B_rn);
    Free(internal->B_sf);
    Free(internal->B_sj);
    Free(internal->B_sm);
    Free(internal->B_sn);
    Free(internal->p);
    Free(internal->p1);
    Free(internal->p2);
    Free(internal->p3);
    Free(internal->p4);
    Free(internal->pf);
    Free(internal->pf1);
    Free(internal->pf2);
    Free(internal->pf3);
    Free(internal->pj);
    Free(internal->pj1);
    Free(internal->pj2);
    Free(internal->pj3);
    Free(internal->pm);
    Free(internal->pm1);
    Free(internal->pm2);
    Free(internal->pm3);
    Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP stochSEIR_create(SEXP user) {
  stochSEIR_internal *internal = (stochSEIR_internal*) Calloc(1, stochSEIR_internal);
  internal->B_ef = NULL;
  internal->B_ej = NULL;
  internal->B_em = NULL;
  internal->B_en = NULL;
  internal->B_if = NULL;
  internal->B_ij = NULL;
  internal->B_im = NULL;
  internal->B_in = NULL;
  internal->B_ma = NULL;
  internal->B_rf = NULL;
  internal->B_rj = NULL;
  internal->B_rm = NULL;
  internal->B_rn = NULL;
  internal->B_sf = NULL;
  internal->B_sj = NULL;
  internal->B_sm = NULL;
  internal->B_sn = NULL;
  internal->p = NULL;
  internal->p1 = NULL;
  internal->p2 = NULL;
  internal->p3 = NULL;
  internal->p4 = NULL;
  internal->pf = NULL;
  internal->pf1 = NULL;
  internal->pf2 = NULL;
  internal->pf3 = NULL;
  internal->pj = NULL;
  internal->pj1 = NULL;
  internal->pj2 = NULL;
  internal->pj3 = NULL;
  internal->pm = NULL;
  internal->pm1 = NULL;
  internal->pm2 = NULL;
  internal->pm3 = NULL;
  internal->beta_1 = 0;
  internal->dim_B_ef = 4;
  internal->dim_B_ej = 5;
  internal->dim_B_em = 4;
  internal->dim_B_en = 5;
  internal->dim_B_if = 4;
  internal->dim_B_ij = 5;
  internal->dim_B_im = 4;
  internal->dim_B_in = 5;
  internal->dim_B_ma = 2;
  internal->dim_B_rf = 2;
  internal->dim_B_rj = 3;
  internal->dim_B_rm = 2;
  internal->dim_B_rn = 4;
  internal->dim_B_sf = 3;
  internal->dim_B_sj = 4;
  internal->dim_B_sm = 3;
  internal->dim_B_sn = 4;
  internal->dim_p = 4;
  internal->dim_p1 = 5;
  internal->dim_p2 = 5;
  internal->dim_p3 = 4;
  internal->dim_p4 = 2;
  internal->dim_pf = 3;
  internal->dim_pf1 = 4;
  internal->dim_pf2 = 4;
  internal->dim_pf3 = 2;
  internal->dim_pj = 4;
  internal->dim_pj1 = 5;
  internal->dim_pj2 = 5;
  internal->dim_pj3 = 3;
  internal->dim_pm = 3;
  internal->dim_pm1 = 4;
  internal->dim_pm2 = 4;
  internal->dim_pm3 = 2;
  internal->initial_R0_out = 0;
  internal->n_Sf_Ef = 0;
  internal->n_Sj_Ej = 0;
  internal->n_Sm_Em = 0;
  internal->n_Sn_En = 0;
  internal->sigma_1 = 0;
  Free(internal->B_ef);
  internal->B_ef = (int*) Calloc(internal->dim_B_ef, int);
  Free(internal->B_ej);
  internal->B_ej = (int*) Calloc(internal->dim_B_ej, int);
  Free(internal->B_em);
  internal->B_em = (int*) Calloc(internal->dim_B_em, int);
  Free(internal->B_en);
  internal->B_en = (int*) Calloc(internal->dim_B_en, int);
  Free(internal->B_if);
  internal->B_if = (int*) Calloc(internal->dim_B_if, int);
  Free(internal->B_ij);
  internal->B_ij = (int*) Calloc(internal->dim_B_ij, int);
  Free(internal->B_im);
  internal->B_im = (int*) Calloc(internal->dim_B_im, int);
  Free(internal->B_in);
  internal->B_in = (int*) Calloc(internal->dim_B_in, int);
  Free(internal->B_ma);
  internal->B_ma = (int*) Calloc(internal->dim_B_ma, int);
  Free(internal->B_rf);
  internal->B_rf = (int*) Calloc(internal->dim_B_rf, int);
  Free(internal->B_rj);
  internal->B_rj = (int*) Calloc(internal->dim_B_rj, int);
  Free(internal->B_rm);
  internal->B_rm = (int*) Calloc(internal->dim_B_rm, int);
  Free(internal->B_rn);
  internal->B_rn = (int*) Calloc(internal->dim_B_rn, int);
  Free(internal->B_sf);
  internal->B_sf = (int*) Calloc(internal->dim_B_sf, int);
  Free(internal->B_sj);
  internal->B_sj = (int*) Calloc(internal->dim_B_sj, int);
  Free(internal->B_sm);
  internal->B_sm = (int*) Calloc(internal->dim_B_sm, int);
  Free(internal->B_sn);
  internal->B_sn = (int*) Calloc(internal->dim_B_sn, int);
  Free(internal->p);
  internal->p = (double*) Calloc(internal->dim_p, double);
  Free(internal->p1);
  internal->p1 = (double*) Calloc(internal->dim_p1, double);
  Free(internal->p2);
  internal->p2 = (double*) Calloc(internal->dim_p2, double);
  Free(internal->p3);
  internal->p3 = (double*) Calloc(internal->dim_p3, double);
  Free(internal->p4);
  internal->p4 = (double*) Calloc(internal->dim_p4, double);
  Free(internal->pf);
  internal->pf = (double*) Calloc(internal->dim_pf, double);
  Free(internal->pf1);
  internal->pf1 = (double*) Calloc(internal->dim_pf1, double);
  Free(internal->pf2);
  internal->pf2 = (double*) Calloc(internal->dim_pf2, double);
  Free(internal->pf3);
  internal->pf3 = (double*) Calloc(internal->dim_pf3, double);
  Free(internal->pj);
  internal->pj = (double*) Calloc(internal->dim_pj, double);
  Free(internal->pj1);
  internal->pj1 = (double*) Calloc(internal->dim_pj1, double);
  Free(internal->pj2);
  internal->pj2 = (double*) Calloc(internal->dim_pj2, double);
  Free(internal->pj3);
  internal->pj3 = (double*) Calloc(internal->dim_pj3, double);
  Free(internal->pm);
  internal->pm = (double*) Calloc(internal->dim_pm, double);
  Free(internal->pm1);
  internal->pm1 = (double*) Calloc(internal->dim_pm1, double);
  Free(internal->pm2);
  internal->pm2 = (double*) Calloc(internal->dim_pm2, double);
  Free(internal->pm3);
  internal->pm3 = (double*) Calloc(internal->dim_pm3, double);
  internal->P_E_S = internal->sigma_1;
  internal->betaFX = 0;
  internal->betaFXVal = 0;
  internal->betaVer = 0;
  internal->birthType = 0;
  internal->c_Val = 1.53;
  internal->c_val2 = 0;
  internal->dt = 365;
  internal->Ef_ini = 5;
  internal->Ej_ini = 5;
  internal->Em_ini = 5;
  internal->En_ini = 5;
  internal->envOscType = 0;
  internal->epsilon_Val = 0.90000000000000002;
  internal->gamma_1_Val = 0.80000000000000004;
  internal->gamma_2_Val = 0;
  internal->gammaVer = 0;
  internal->If_ini = 0;
  internal->Ij_ini = 0;
  internal->Im_ini = 0;
  internal->In_ini = 0;
  internal->kappa_Val = 1000;
  internal->m_Val = 0.186;
  internal->Ma_ini = 0;
  internal->mj_Val = 0.79600000000000004;
  internal->mu_Val = 0.44;
  internal->omega_2_Val = 0.40000000000000002;
  internal->omega_m_Val = 0.40000000000000002;
  internal->phi_Val = 4.5;
  internal->Phi2_val = 0;
  internal->R0_Val = 0.5;
  internal->Rf_ini = 0;
  internal->rho_Val = 0.90000000000000002;
  internal->Rj_ini = 0;
  internal->Rm_ini = 0;
  internal->Rn_ini = 0;
  internal->s_Val = 14.300000000000001;
  internal->S2_val = 0;
  internal->Sf_ini = 20;
  internal->sigma_2_Val = 0;
  internal->sigmaVer = 0;
  internal->Sj_ini = 20;
  internal->Sm_ini = 20;
  internal->Sn_ini = 20;
  internal->timeOscIni = 0;
  internal->zeta_s = 0.80000000000000004;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, stochSEIR_finalise);
  UNPROTECT(1);
  return ptr;
}
static stochSEIR_internal *stochSEIR_internal_ds;
void stochSEIR_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  stochSEIR_internal_ds = stochSEIR_get_internal(get_desolve_gparms(), 1);
}
SEXP stochSEIR_contents(SEXP internal_p) {
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 158));
  SEXP B_ef = PROTECT(allocVector(INTSXP, internal->dim_B_ef));
  memcpy(INTEGER(B_ef), internal->B_ef, internal->dim_B_ef * sizeof(int));
  SET_VECTOR_ELT(contents, 0, B_ef);
  SEXP B_ej = PROTECT(allocVector(INTSXP, internal->dim_B_ej));
  memcpy(INTEGER(B_ej), internal->B_ej, internal->dim_B_ej * sizeof(int));
  SET_VECTOR_ELT(contents, 1, B_ej);
  SEXP B_em = PROTECT(allocVector(INTSXP, internal->dim_B_em));
  memcpy(INTEGER(B_em), internal->B_em, internal->dim_B_em * sizeof(int));
  SET_VECTOR_ELT(contents, 2, B_em);
  SEXP B_en = PROTECT(allocVector(INTSXP, internal->dim_B_en));
  memcpy(INTEGER(B_en), internal->B_en, internal->dim_B_en * sizeof(int));
  SET_VECTOR_ELT(contents, 3, B_en);
  SEXP B_if = PROTECT(allocVector(INTSXP, internal->dim_B_if));
  memcpy(INTEGER(B_if), internal->B_if, internal->dim_B_if * sizeof(int));
  SET_VECTOR_ELT(contents, 4, B_if);
  SEXP B_ij = PROTECT(allocVector(INTSXP, internal->dim_B_ij));
  memcpy(INTEGER(B_ij), internal->B_ij, internal->dim_B_ij * sizeof(int));
  SET_VECTOR_ELT(contents, 5, B_ij);
  SEXP B_im = PROTECT(allocVector(INTSXP, internal->dim_B_im));
  memcpy(INTEGER(B_im), internal->B_im, internal->dim_B_im * sizeof(int));
  SET_VECTOR_ELT(contents, 6, B_im);
  SEXP B_in = PROTECT(allocVector(INTSXP, internal->dim_B_in));
  memcpy(INTEGER(B_in), internal->B_in, internal->dim_B_in * sizeof(int));
  SET_VECTOR_ELT(contents, 7, B_in);
  SEXP B_ma = PROTECT(allocVector(INTSXP, internal->dim_B_ma));
  memcpy(INTEGER(B_ma), internal->B_ma, internal->dim_B_ma * sizeof(int));
  SET_VECTOR_ELT(contents, 8, B_ma);
  SEXP B_rf = PROTECT(allocVector(INTSXP, internal->dim_B_rf));
  memcpy(INTEGER(B_rf), internal->B_rf, internal->dim_B_rf * sizeof(int));
  SET_VECTOR_ELT(contents, 9, B_rf);
  SEXP B_rj = PROTECT(allocVector(INTSXP, internal->dim_B_rj));
  memcpy(INTEGER(B_rj), internal->B_rj, internal->dim_B_rj * sizeof(int));
  SET_VECTOR_ELT(contents, 10, B_rj);
  SEXP B_rm = PROTECT(allocVector(INTSXP, internal->dim_B_rm));
  memcpy(INTEGER(B_rm), internal->B_rm, internal->dim_B_rm * sizeof(int));
  SET_VECTOR_ELT(contents, 11, B_rm);
  SEXP B_rn = PROTECT(allocVector(INTSXP, internal->dim_B_rn));
  memcpy(INTEGER(B_rn), internal->B_rn, internal->dim_B_rn * sizeof(int));
  SET_VECTOR_ELT(contents, 12, B_rn);
  SEXP B_sf = PROTECT(allocVector(INTSXP, internal->dim_B_sf));
  memcpy(INTEGER(B_sf), internal->B_sf, internal->dim_B_sf * sizeof(int));
  SET_VECTOR_ELT(contents, 13, B_sf);
  SEXP B_sj = PROTECT(allocVector(INTSXP, internal->dim_B_sj));
  memcpy(INTEGER(B_sj), internal->B_sj, internal->dim_B_sj * sizeof(int));
  SET_VECTOR_ELT(contents, 14, B_sj);
  SEXP B_sm = PROTECT(allocVector(INTSXP, internal->dim_B_sm));
  memcpy(INTEGER(B_sm), internal->B_sm, internal->dim_B_sm * sizeof(int));
  SET_VECTOR_ELT(contents, 15, B_sm);
  SEXP B_sn = PROTECT(allocVector(INTSXP, internal->dim_B_sn));
  memcpy(INTEGER(B_sn), internal->B_sn, internal->dim_B_sn * sizeof(int));
  SET_VECTOR_ELT(contents, 16, B_sn);
  SET_VECTOR_ELT(contents, 17, ScalarReal(internal->beta_1));
  SET_VECTOR_ELT(contents, 18, ScalarReal(internal->betaFX));
  SET_VECTOR_ELT(contents, 19, ScalarReal(internal->betaFXVal));
  SET_VECTOR_ELT(contents, 20, ScalarReal(internal->betaVer));
  SET_VECTOR_ELT(contents, 21, ScalarReal(internal->birthType));
  SET_VECTOR_ELT(contents, 22, ScalarReal(internal->c));
  SET_VECTOR_ELT(contents, 23, ScalarReal(internal->c_Val));
  SET_VECTOR_ELT(contents, 24, ScalarReal(internal->c_val2));
  SET_VECTOR_ELT(contents, 25, ScalarReal(internal->cV));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_B_ef));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_B_ej));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_B_em));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_B_en));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_B_if));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_B_ij));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_B_im));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_B_in));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_B_ma));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_B_rf));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_B_rj));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_B_rm));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_B_rn));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_B_sf));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_B_sj));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_B_sm));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_B_sn));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_p));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_p1));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_p2));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_p3));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_p4));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_pf));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_pf1));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_pf2));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_pf3));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_pj));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_pj1));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_pj2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_pj3));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_pm));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_pm1));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_pm2));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_pm3));
  SET_VECTOR_ELT(contents, 60, ScalarReal(internal->dt));
  SET_VECTOR_ELT(contents, 61, ScalarReal(internal->Ef_ini));
  SET_VECTOR_ELT(contents, 62, ScalarReal(internal->Ej_ini));
  SET_VECTOR_ELT(contents, 63, ScalarReal(internal->Em_ini));
  SET_VECTOR_ELT(contents, 64, ScalarReal(internal->En_ini));
  SET_VECTOR_ELT(contents, 65, ScalarReal(internal->envOscType));
  SET_VECTOR_ELT(contents, 66, ScalarReal(internal->epsilon_Val));
  SET_VECTOR_ELT(contents, 67, ScalarReal(internal->gamma_1));
  SET_VECTOR_ELT(contents, 68, ScalarReal(internal->gamma_1_Val));
  SET_VECTOR_ELT(contents, 69, ScalarReal(internal->gamma_2_Val));
  SET_VECTOR_ELT(contents, 70, ScalarReal(internal->gammaVer));
  SET_VECTOR_ELT(contents, 71, ScalarReal(internal->If_ini));
  SET_VECTOR_ELT(contents, 72, ScalarReal(internal->Ij_ini));
  SET_VECTOR_ELT(contents, 73, ScalarReal(internal->Im_ini));
  SET_VECTOR_ELT(contents, 74, ScalarReal(internal->In_ini));
  SET_VECTOR_ELT(contents, 75, ScalarReal(internal->initial_Ef));
  SET_VECTOR_ELT(contents, 76, ScalarReal(internal->initial_Ej));
  SET_VECTOR_ELT(contents, 77, ScalarReal(internal->initial_Em));
  SET_VECTOR_ELT(contents, 78, ScalarReal(internal->initial_En));
  SET_VECTOR_ELT(contents, 79, ScalarReal(internal->initial_If));
  SET_VECTOR_ELT(contents, 80, ScalarReal(internal->initial_Ij));
  SET_VECTOR_ELT(contents, 81, ScalarReal(internal->initial_Im));
  SET_VECTOR_ELT(contents, 82, ScalarReal(internal->initial_In));
  SET_VECTOR_ELT(contents, 83, ScalarReal(internal->initial_Ma));
  SET_VECTOR_ELT(contents, 84, ScalarReal(internal->initial_R0_out));
  SET_VECTOR_ELT(contents, 85, ScalarReal(internal->initial_Rf));
  SET_VECTOR_ELT(contents, 86, ScalarReal(internal->initial_Rj));
  SET_VECTOR_ELT(contents, 87, ScalarReal(internal->initial_Rm));
  SET_VECTOR_ELT(contents, 88, ScalarReal(internal->initial_Rn));
  SET_VECTOR_ELT(contents, 89, ScalarReal(internal->initial_Sf));
  SET_VECTOR_ELT(contents, 90, ScalarReal(internal->initial_Sj));
  SET_VECTOR_ELT(contents, 91, ScalarReal(internal->initial_Sm));
  SET_VECTOR_ELT(contents, 92, ScalarReal(internal->initial_Sn));
  SET_VECTOR_ELT(contents, 93, ScalarReal(internal->initial_timeOsc));
  SET_VECTOR_ELT(contents, 94, ScalarReal(internal->kappa));
  SET_VECTOR_ELT(contents, 95, ScalarReal(internal->kappa_Val));
  SET_VECTOR_ELT(contents, 96, ScalarReal(internal->m));
  SET_VECTOR_ELT(contents, 97, ScalarReal(internal->m_Val));
  SET_VECTOR_ELT(contents, 98, ScalarReal(internal->Ma_ini));
  SET_VECTOR_ELT(contents, 99, ScalarReal(internal->mj));
  SET_VECTOR_ELT(contents, 100, ScalarReal(internal->mj_Val));
  SET_VECTOR_ELT(contents, 101, ScalarReal(internal->mu));
  SET_VECTOR_ELT(contents, 102, ScalarReal(internal->mu_Val));
  SET_VECTOR_ELT(contents, 103, ScalarReal(internal->n_Sf_Ef));
  SET_VECTOR_ELT(contents, 104, ScalarReal(internal->n_Sj_Ej));
  SET_VECTOR_ELT(contents, 105, ScalarReal(internal->n_Sm_Em));
  SET_VECTOR_ELT(contents, 106, ScalarReal(internal->n_Sn_En));
  SET_VECTOR_ELT(contents, 107, ScalarReal(internal->omega_2_Val));
  SET_VECTOR_ELT(contents, 108, ScalarReal(internal->omega_m));
  SET_VECTOR_ELT(contents, 109, ScalarReal(internal->omega_m_Val));
  SEXP p = PROTECT(allocVector(REALSXP, internal->dim_p));
  memcpy(REAL(p), internal->p, internal->dim_p * sizeof(double));
  SET_VECTOR_ELT(contents, 110, p);
  SET_VECTOR_ELT(contents, 111, ScalarReal(internal->P_E_R));
  SET_VECTOR_ELT(contents, 112, ScalarReal(internal->P_E_S));
  SET_VECTOR_ELT(contents, 113, ScalarReal(internal->P_I_E));
  SET_VECTOR_ELT(contents, 114, ScalarReal(internal->P_I_S));
  SET_VECTOR_ELT(contents, 115, ScalarReal(internal->P_J_A));
  SET_VECTOR_ELT(contents, 116, ScalarReal(internal->P_matWane));
  SEXP p1 = PROTECT(allocVector(REALSXP, internal->dim_p1));
  memcpy(REAL(p1), internal->p1, internal->dim_p1 * sizeof(double));
  SET_VECTOR_ELT(contents, 117, p1);
  SEXP p2 = PROTECT(allocVector(REALSXP, internal->dim_p2));
  memcpy(REAL(p2), internal->p2, internal->dim_p2 * sizeof(double));
  SET_VECTOR_ELT(contents, 118, p2);
  SEXP p3 = PROTECT(allocVector(REALSXP, internal->dim_p3));
  memcpy(REAL(p3), internal->p3, internal->dim_p3 * sizeof(double));
  SET_VECTOR_ELT(contents, 119, p3);
  SEXP p4 = PROTECT(allocVector(REALSXP, internal->dim_p4));
  memcpy(REAL(p4), internal->p4, internal->dim_p4 * sizeof(double));
  SET_VECTOR_ELT(contents, 120, p4);
  SEXP pf = PROTECT(allocVector(REALSXP, internal->dim_pf));
  memcpy(REAL(pf), internal->pf, internal->dim_pf * sizeof(double));
  SET_VECTOR_ELT(contents, 121, pf);
  SEXP pf1 = PROTECT(allocVector(REALSXP, internal->dim_pf1));
  memcpy(REAL(pf1), internal->pf1, internal->dim_pf1 * sizeof(double));
  SET_VECTOR_ELT(contents, 122, pf1);
  SEXP pf2 = PROTECT(allocVector(REALSXP, internal->dim_pf2));
  memcpy(REAL(pf2), internal->pf2, internal->dim_pf2 * sizeof(double));
  SET_VECTOR_ELT(contents, 123, pf2);
  SEXP pf3 = PROTECT(allocVector(REALSXP, internal->dim_pf3));
  memcpy(REAL(pf3), internal->pf3, internal->dim_pf3 * sizeof(double));
  SET_VECTOR_ELT(contents, 124, pf3);
  SET_VECTOR_ELT(contents, 125, ScalarReal(internal->phi));
  SET_VECTOR_ELT(contents, 126, ScalarReal(internal->phi_Val));
  SET_VECTOR_ELT(contents, 127, ScalarReal(internal->Phi2_val));
  SET_VECTOR_ELT(contents, 128, ScalarReal(internal->phiV));
  SEXP pj = PROTECT(allocVector(REALSXP, internal->dim_pj));
  memcpy(REAL(pj), internal->pj, internal->dim_pj * sizeof(double));
  SET_VECTOR_ELT(contents, 129, pj);
  SEXP pj1 = PROTECT(allocVector(REALSXP, internal->dim_pj1));
  memcpy(REAL(pj1), internal->pj1, internal->dim_pj1 * sizeof(double));
  SET_VECTOR_ELT(contents, 130, pj1);
  SEXP pj2 = PROTECT(allocVector(REALSXP, internal->dim_pj2));
  memcpy(REAL(pj2), internal->pj2, internal->dim_pj2 * sizeof(double));
  SET_VECTOR_ELT(contents, 131, pj2);
  SEXP pj3 = PROTECT(allocVector(REALSXP, internal->dim_pj3));
  memcpy(REAL(pj3), internal->pj3, internal->dim_pj3 * sizeof(double));
  SET_VECTOR_ELT(contents, 132, pj3);
  SEXP pm = PROTECT(allocVector(REALSXP, internal->dim_pm));
  memcpy(REAL(pm), internal->pm, internal->dim_pm * sizeof(double));
  SET_VECTOR_ELT(contents, 133, pm);
  SEXP pm1 = PROTECT(allocVector(REALSXP, internal->dim_pm1));
  memcpy(REAL(pm1), internal->pm1, internal->dim_pm1 * sizeof(double));
  SET_VECTOR_ELT(contents, 134, pm1);
  SEXP pm2 = PROTECT(allocVector(REALSXP, internal->dim_pm2));
  memcpy(REAL(pm2), internal->pm2, internal->dim_pm2 * sizeof(double));
  SET_VECTOR_ELT(contents, 135, pm2);
  SEXP pm3 = PROTECT(allocVector(REALSXP, internal->dim_pm3));
  memcpy(REAL(pm3), internal->pm3, internal->dim_pm3 * sizeof(double));
  SET_VECTOR_ELT(contents, 136, pm3);
  SET_VECTOR_ELT(contents, 137, ScalarReal(internal->R0_Val));
  SET_VECTOR_ELT(contents, 138, ScalarReal(internal->Rf_ini));
  SET_VECTOR_ELT(contents, 139, ScalarReal(internal->rho));
  SET_VECTOR_ELT(contents, 140, ScalarReal(internal->rho_Val));
  SET_VECTOR_ELT(contents, 141, ScalarReal(internal->Rj_ini));
  SET_VECTOR_ELT(contents, 142, ScalarReal(internal->Rm_ini));
  SET_VECTOR_ELT(contents, 143, ScalarReal(internal->Rn_ini));
  SET_VECTOR_ELT(contents, 144, ScalarReal(internal->s));
  SET_VECTOR_ELT(contents, 145, ScalarReal(internal->s_Val));
  SET_VECTOR_ELT(contents, 146, ScalarReal(internal->S2_val));
  SET_VECTOR_ELT(contents, 147, ScalarReal(internal->Sf_ini));
  SET_VECTOR_ELT(contents, 148, ScalarReal(internal->sigma_1));
  SET_VECTOR_ELT(contents, 149, ScalarReal(internal->sigma_2));
  SET_VECTOR_ELT(contents, 150, ScalarReal(internal->sigma_2_Val));
  SET_VECTOR_ELT(contents, 151, ScalarReal(internal->sigmaVer));
  SET_VECTOR_ELT(contents, 152, ScalarReal(internal->Sj_ini));
  SET_VECTOR_ELT(contents, 153, ScalarReal(internal->Sm_ini));
  SET_VECTOR_ELT(contents, 154, ScalarReal(internal->Sn_ini));
  SET_VECTOR_ELT(contents, 155, ScalarReal(internal->sV));
  SET_VECTOR_ELT(contents, 156, ScalarReal(internal->timeOscIni));
  SET_VECTOR_ELT(contents, 157, ScalarReal(internal->zeta_s));
  SEXP nms = PROTECT(allocVector(STRSXP, 158));
  SET_STRING_ELT(nms, 0, mkChar("B_ef"));
  SET_STRING_ELT(nms, 1, mkChar("B_ej"));
  SET_STRING_ELT(nms, 2, mkChar("B_em"));
  SET_STRING_ELT(nms, 3, mkChar("B_en"));
  SET_STRING_ELT(nms, 4, mkChar("B_if"));
  SET_STRING_ELT(nms, 5, mkChar("B_ij"));
  SET_STRING_ELT(nms, 6, mkChar("B_im"));
  SET_STRING_ELT(nms, 7, mkChar("B_in"));
  SET_STRING_ELT(nms, 8, mkChar("B_ma"));
  SET_STRING_ELT(nms, 9, mkChar("B_rf"));
  SET_STRING_ELT(nms, 10, mkChar("B_rj"));
  SET_STRING_ELT(nms, 11, mkChar("B_rm"));
  SET_STRING_ELT(nms, 12, mkChar("B_rn"));
  SET_STRING_ELT(nms, 13, mkChar("B_sf"));
  SET_STRING_ELT(nms, 14, mkChar("B_sj"));
  SET_STRING_ELT(nms, 15, mkChar("B_sm"));
  SET_STRING_ELT(nms, 16, mkChar("B_sn"));
  SET_STRING_ELT(nms, 17, mkChar("beta_1"));
  SET_STRING_ELT(nms, 18, mkChar("betaFX"));
  SET_STRING_ELT(nms, 19, mkChar("betaFXVal"));
  SET_STRING_ELT(nms, 20, mkChar("betaVer"));
  SET_STRING_ELT(nms, 21, mkChar("birthType"));
  SET_STRING_ELT(nms, 22, mkChar("c"));
  SET_STRING_ELT(nms, 23, mkChar("c_Val"));
  SET_STRING_ELT(nms, 24, mkChar("c_val2"));
  SET_STRING_ELT(nms, 25, mkChar("cV"));
  SET_STRING_ELT(nms, 26, mkChar("dim_B_ef"));
  SET_STRING_ELT(nms, 27, mkChar("dim_B_ej"));
  SET_STRING_ELT(nms, 28, mkChar("dim_B_em"));
  SET_STRING_ELT(nms, 29, mkChar("dim_B_en"));
  SET_STRING_ELT(nms, 30, mkChar("dim_B_if"));
  SET_STRING_ELT(nms, 31, mkChar("dim_B_ij"));
  SET_STRING_ELT(nms, 32, mkChar("dim_B_im"));
  SET_STRING_ELT(nms, 33, mkChar("dim_B_in"));
  SET_STRING_ELT(nms, 34, mkChar("dim_B_ma"));
  SET_STRING_ELT(nms, 35, mkChar("dim_B_rf"));
  SET_STRING_ELT(nms, 36, mkChar("dim_B_rj"));
  SET_STRING_ELT(nms, 37, mkChar("dim_B_rm"));
  SET_STRING_ELT(nms, 38, mkChar("dim_B_rn"));
  SET_STRING_ELT(nms, 39, mkChar("dim_B_sf"));
  SET_STRING_ELT(nms, 40, mkChar("dim_B_sj"));
  SET_STRING_ELT(nms, 41, mkChar("dim_B_sm"));
  SET_STRING_ELT(nms, 42, mkChar("dim_B_sn"));
  SET_STRING_ELT(nms, 43, mkChar("dim_p"));
  SET_STRING_ELT(nms, 44, mkChar("dim_p1"));
  SET_STRING_ELT(nms, 45, mkChar("dim_p2"));
  SET_STRING_ELT(nms, 46, mkChar("dim_p3"));
  SET_STRING_ELT(nms, 47, mkChar("dim_p4"));
  SET_STRING_ELT(nms, 48, mkChar("dim_pf"));
  SET_STRING_ELT(nms, 49, mkChar("dim_pf1"));
  SET_STRING_ELT(nms, 50, mkChar("dim_pf2"));
  SET_STRING_ELT(nms, 51, mkChar("dim_pf3"));
  SET_STRING_ELT(nms, 52, mkChar("dim_pj"));
  SET_STRING_ELT(nms, 53, mkChar("dim_pj1"));
  SET_STRING_ELT(nms, 54, mkChar("dim_pj2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_pj3"));
  SET_STRING_ELT(nms, 56, mkChar("dim_pm"));
  SET_STRING_ELT(nms, 57, mkChar("dim_pm1"));
  SET_STRING_ELT(nms, 58, mkChar("dim_pm2"));
  SET_STRING_ELT(nms, 59, mkChar("dim_pm3"));
  SET_STRING_ELT(nms, 60, mkChar("dt"));
  SET_STRING_ELT(nms, 61, mkChar("Ef_ini"));
  SET_STRING_ELT(nms, 62, mkChar("Ej_ini"));
  SET_STRING_ELT(nms, 63, mkChar("Em_ini"));
  SET_STRING_ELT(nms, 64, mkChar("En_ini"));
  SET_STRING_ELT(nms, 65, mkChar("envOscType"));
  SET_STRING_ELT(nms, 66, mkChar("epsilon_Val"));
  SET_STRING_ELT(nms, 67, mkChar("gamma_1"));
  SET_STRING_ELT(nms, 68, mkChar("gamma_1_Val"));
  SET_STRING_ELT(nms, 69, mkChar("gamma_2_Val"));
  SET_STRING_ELT(nms, 70, mkChar("gammaVer"));
  SET_STRING_ELT(nms, 71, mkChar("If_ini"));
  SET_STRING_ELT(nms, 72, mkChar("Ij_ini"));
  SET_STRING_ELT(nms, 73, mkChar("Im_ini"));
  SET_STRING_ELT(nms, 74, mkChar("In_ini"));
  SET_STRING_ELT(nms, 75, mkChar("initial_Ef"));
  SET_STRING_ELT(nms, 76, mkChar("initial_Ej"));
  SET_STRING_ELT(nms, 77, mkChar("initial_Em"));
  SET_STRING_ELT(nms, 78, mkChar("initial_En"));
  SET_STRING_ELT(nms, 79, mkChar("initial_If"));
  SET_STRING_ELT(nms, 80, mkChar("initial_Ij"));
  SET_STRING_ELT(nms, 81, mkChar("initial_Im"));
  SET_STRING_ELT(nms, 82, mkChar("initial_In"));
  SET_STRING_ELT(nms, 83, mkChar("initial_Ma"));
  SET_STRING_ELT(nms, 84, mkChar("initial_R0_out"));
  SET_STRING_ELT(nms, 85, mkChar("initial_Rf"));
  SET_STRING_ELT(nms, 86, mkChar("initial_Rj"));
  SET_STRING_ELT(nms, 87, mkChar("initial_Rm"));
  SET_STRING_ELT(nms, 88, mkChar("initial_Rn"));
  SET_STRING_ELT(nms, 89, mkChar("initial_Sf"));
  SET_STRING_ELT(nms, 90, mkChar("initial_Sj"));
  SET_STRING_ELT(nms, 91, mkChar("initial_Sm"));
  SET_STRING_ELT(nms, 92, mkChar("initial_Sn"));
  SET_STRING_ELT(nms, 93, mkChar("initial_timeOsc"));
  SET_STRING_ELT(nms, 94, mkChar("kappa"));
  SET_STRING_ELT(nms, 95, mkChar("kappa_Val"));
  SET_STRING_ELT(nms, 96, mkChar("m"));
  SET_STRING_ELT(nms, 97, mkChar("m_Val"));
  SET_STRING_ELT(nms, 98, mkChar("Ma_ini"));
  SET_STRING_ELT(nms, 99, mkChar("mj"));
  SET_STRING_ELT(nms, 100, mkChar("mj_Val"));
  SET_STRING_ELT(nms, 101, mkChar("mu"));
  SET_STRING_ELT(nms, 102, mkChar("mu_Val"));
  SET_STRING_ELT(nms, 103, mkChar("n_Sf_Ef"));
  SET_STRING_ELT(nms, 104, mkChar("n_Sj_Ej"));
  SET_STRING_ELT(nms, 105, mkChar("n_Sm_Em"));
  SET_STRING_ELT(nms, 106, mkChar("n_Sn_En"));
  SET_STRING_ELT(nms, 107, mkChar("omega_2_Val"));
  SET_STRING_ELT(nms, 108, mkChar("omega_m"));
  SET_STRING_ELT(nms, 109, mkChar("omega_m_Val"));
  SET_STRING_ELT(nms, 110, mkChar("p"));
  SET_STRING_ELT(nms, 111, mkChar("P_E_R"));
  SET_STRING_ELT(nms, 112, mkChar("P_E_S"));
  SET_STRING_ELT(nms, 113, mkChar("P_I_E"));
  SET_STRING_ELT(nms, 114, mkChar("P_I_S"));
  SET_STRING_ELT(nms, 115, mkChar("P_J_A"));
  SET_STRING_ELT(nms, 116, mkChar("P_matWane"));
  SET_STRING_ELT(nms, 117, mkChar("p1"));
  SET_STRING_ELT(nms, 118, mkChar("p2"));
  SET_STRING_ELT(nms, 119, mkChar("p3"));
  SET_STRING_ELT(nms, 120, mkChar("p4"));
  SET_STRING_ELT(nms, 121, mkChar("pf"));
  SET_STRING_ELT(nms, 122, mkChar("pf1"));
  SET_STRING_ELT(nms, 123, mkChar("pf2"));
  SET_STRING_ELT(nms, 124, mkChar("pf3"));
  SET_STRING_ELT(nms, 125, mkChar("phi"));
  SET_STRING_ELT(nms, 126, mkChar("phi_Val"));
  SET_STRING_ELT(nms, 127, mkChar("Phi2_val"));
  SET_STRING_ELT(nms, 128, mkChar("phiV"));
  SET_STRING_ELT(nms, 129, mkChar("pj"));
  SET_STRING_ELT(nms, 130, mkChar("pj1"));
  SET_STRING_ELT(nms, 131, mkChar("pj2"));
  SET_STRING_ELT(nms, 132, mkChar("pj3"));
  SET_STRING_ELT(nms, 133, mkChar("pm"));
  SET_STRING_ELT(nms, 134, mkChar("pm1"));
  SET_STRING_ELT(nms, 135, mkChar("pm2"));
  SET_STRING_ELT(nms, 136, mkChar("pm3"));
  SET_STRING_ELT(nms, 137, mkChar("R0_Val"));
  SET_STRING_ELT(nms, 138, mkChar("Rf_ini"));
  SET_STRING_ELT(nms, 139, mkChar("rho"));
  SET_STRING_ELT(nms, 140, mkChar("rho_Val"));
  SET_STRING_ELT(nms, 141, mkChar("Rj_ini"));
  SET_STRING_ELT(nms, 142, mkChar("Rm_ini"));
  SET_STRING_ELT(nms, 143, mkChar("Rn_ini"));
  SET_STRING_ELT(nms, 144, mkChar("s"));
  SET_STRING_ELT(nms, 145, mkChar("s_Val"));
  SET_STRING_ELT(nms, 146, mkChar("S2_val"));
  SET_STRING_ELT(nms, 147, mkChar("Sf_ini"));
  SET_STRING_ELT(nms, 148, mkChar("sigma_1"));
  SET_STRING_ELT(nms, 149, mkChar("sigma_2"));
  SET_STRING_ELT(nms, 150, mkChar("sigma_2_Val"));
  SET_STRING_ELT(nms, 151, mkChar("sigmaVer"));
  SET_STRING_ELT(nms, 152, mkChar("Sj_ini"));
  SET_STRING_ELT(nms, 153, mkChar("Sm_ini"));
  SET_STRING_ELT(nms, 154, mkChar("Sn_ini"));
  SET_STRING_ELT(nms, 155, mkChar("sV"));
  SET_STRING_ELT(nms, 156, mkChar("timeOscIni"));
  SET_STRING_ELT(nms, 157, mkChar("zeta_s"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(36);
  return contents;
}
SEXP stochSEIR_set_user(SEXP internal_p, SEXP user) {
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 1);
  internal->betaFX = user_get_scalar_double(user, "betaFX", internal->betaFX, NA_REAL, NA_REAL);
  internal->betaFXVal = user_get_scalar_double(user, "betaFXVal", internal->betaFXVal, NA_REAL, NA_REAL);
  internal->betaVer = user_get_scalar_double(user, "betaVer", internal->betaVer, NA_REAL, NA_REAL);
  internal->birthType = user_get_scalar_double(user, "birthType", internal->birthType, NA_REAL, NA_REAL);
  internal->c_Val = user_get_scalar_double(user, "c_Val", internal->c_Val, NA_REAL, NA_REAL);
  internal->c_val2 = user_get_scalar_double(user, "c_val2", internal->c_val2, NA_REAL, NA_REAL);
  internal->dt = user_get_scalar_double(user, "dt", internal->dt, NA_REAL, NA_REAL);
  internal->Ef_ini = user_get_scalar_double(user, "Ef_ini", internal->Ef_ini, NA_REAL, NA_REAL);
  internal->Ej_ini = user_get_scalar_double(user, "Ej_ini", internal->Ej_ini, NA_REAL, NA_REAL);
  internal->Em_ini = user_get_scalar_double(user, "Em_ini", internal->Em_ini, NA_REAL, NA_REAL);
  internal->En_ini = user_get_scalar_double(user, "En_ini", internal->En_ini, NA_REAL, NA_REAL);
  internal->envOscType = user_get_scalar_double(user, "envOscType", internal->envOscType, NA_REAL, NA_REAL);
  internal->epsilon_Val = user_get_scalar_double(user, "epsilon_Val", internal->epsilon_Val, NA_REAL, NA_REAL);
  internal->gamma_1_Val = user_get_scalar_double(user, "gamma_1_Val", internal->gamma_1_Val, NA_REAL, NA_REAL);
  internal->gamma_2_Val = user_get_scalar_double(user, "gamma_2_Val", internal->gamma_2_Val, NA_REAL, NA_REAL);
  internal->gammaVer = user_get_scalar_double(user, "gammaVer", internal->gammaVer, NA_REAL, NA_REAL);
  internal->If_ini = user_get_scalar_double(user, "If_ini", internal->If_ini, NA_REAL, NA_REAL);
  internal->Ij_ini = user_get_scalar_double(user, "Ij_ini", internal->Ij_ini, NA_REAL, NA_REAL);
  internal->Im_ini = user_get_scalar_double(user, "Im_ini", internal->Im_ini, NA_REAL, NA_REAL);
  internal->In_ini = user_get_scalar_double(user, "In_ini", internal->In_ini, NA_REAL, NA_REAL);
  internal->kappa_Val = user_get_scalar_double(user, "kappa_Val", internal->kappa_Val, NA_REAL, NA_REAL);
  internal->m_Val = user_get_scalar_double(user, "m_Val", internal->m_Val, NA_REAL, NA_REAL);
  internal->Ma_ini = user_get_scalar_double(user, "Ma_ini", internal->Ma_ini, NA_REAL, NA_REAL);
  internal->mj_Val = user_get_scalar_double(user, "mj_Val", internal->mj_Val, NA_REAL, NA_REAL);
  internal->mu_Val = user_get_scalar_double(user, "mu_Val", internal->mu_Val, NA_REAL, NA_REAL);
  internal->omega_2_Val = user_get_scalar_double(user, "omega_2_Val", internal->omega_2_Val, NA_REAL, NA_REAL);
  internal->omega_m_Val = user_get_scalar_double(user, "omega_m_Val", internal->omega_m_Val, NA_REAL, NA_REAL);
  internal->phi_Val = user_get_scalar_double(user, "phi_Val", internal->phi_Val, NA_REAL, NA_REAL);
  internal->Phi2_val = user_get_scalar_double(user, "Phi2_val", internal->Phi2_val, NA_REAL, NA_REAL);
  internal->R0_Val = user_get_scalar_double(user, "R0_Val", internal->R0_Val, NA_REAL, NA_REAL);
  internal->Rf_ini = user_get_scalar_double(user, "Rf_ini", internal->Rf_ini, NA_REAL, NA_REAL);
  internal->rho_Val = user_get_scalar_double(user, "rho_Val", internal->rho_Val, NA_REAL, NA_REAL);
  internal->Rj_ini = user_get_scalar_double(user, "Rj_ini", internal->Rj_ini, NA_REAL, NA_REAL);
  internal->Rm_ini = user_get_scalar_double(user, "Rm_ini", internal->Rm_ini, NA_REAL, NA_REAL);
  internal->Rn_ini = user_get_scalar_double(user, "Rn_ini", internal->Rn_ini, NA_REAL, NA_REAL);
  internal->s_Val = user_get_scalar_double(user, "s_Val", internal->s_Val, NA_REAL, NA_REAL);
  internal->S2_val = user_get_scalar_double(user, "S2_val", internal->S2_val, NA_REAL, NA_REAL);
  internal->Sf_ini = user_get_scalar_double(user, "Sf_ini", internal->Sf_ini, NA_REAL, NA_REAL);
  internal->sigma_2_Val = user_get_scalar_double(user, "sigma_2_Val", internal->sigma_2_Val, NA_REAL, NA_REAL);
  internal->sigmaVer = user_get_scalar_double(user, "sigmaVer", internal->sigmaVer, NA_REAL, NA_REAL);
  internal->Sj_ini = user_get_scalar_double(user, "Sj_ini", internal->Sj_ini, NA_REAL, NA_REAL);
  internal->Sm_ini = user_get_scalar_double(user, "Sm_ini", internal->Sm_ini, NA_REAL, NA_REAL);
  internal->Sn_ini = user_get_scalar_double(user, "Sn_ini", internal->Sn_ini, NA_REAL, NA_REAL);
  internal->timeOscIni = user_get_scalar_double(user, "timeOscIni", internal->timeOscIni, NA_REAL, NA_REAL);
  internal->zeta_s = user_get_scalar_double(user, "zeta_s", internal->zeta_s, NA_REAL, NA_REAL);
  internal->c = internal->c_Val;
  internal->cV = internal->c_val2;
  internal->gamma_1 = (internal->gammaVer == 1 ? internal->gamma_1_Val / (double) internal->dt : 0);
  internal->initial_Ef = internal->Ef_ini;
  internal->initial_Ej = internal->Ej_ini;
  internal->initial_Em = internal->Em_ini;
  internal->initial_En = internal->En_ini;
  internal->initial_If = internal->If_ini;
  internal->initial_Ij = internal->Ij_ini;
  internal->initial_Im = internal->Im_ini;
  internal->initial_In = internal->In_ini;
  internal->initial_Ma = internal->Ma_ini;
  internal->initial_Rf = internal->Rf_ini;
  internal->initial_Rj = internal->Rj_ini;
  internal->initial_Rm = internal->Rm_ini;
  internal->initial_Rn = internal->Rn_ini;
  internal->initial_Sf = internal->Sf_ini;
  internal->initial_Sj = internal->Sj_ini;
  internal->initial_Sm = internal->Sm_ini;
  internal->initial_Sn = internal->Sn_ini;
  internal->initial_timeOsc = internal->timeOscIni;
  internal->kappa = internal->kappa_Val;
  internal->m = internal->m_Val / (double) internal->dt;
  internal->mj = internal->mj_Val / (double) internal->dt;
  internal->mu = internal->mu_Val / (double) internal->dt;
  internal->omega_m = internal->omega_m_Val / (double) internal->dt;
  internal->phi = internal->phi_Val;
  internal->phiV = internal->Phi2_val;
  internal->rho = internal->rho_Val / (double) internal->dt;
  internal->s = internal->s_Val;
  internal->sigma_2 = (internal->sigmaVer == 2 ? internal->sigma_2_Val / (double) internal->dt : 0);
  internal->sV = internal->S2_val;
  internal->P_E_R = internal->sigma_2;
  internal->P_I_E = internal->rho;
  internal->P_I_S = internal->gamma_1;
  internal->P_J_A = internal->mu;
  internal->P_matWane = internal->omega_m;
  return R_NilValue;
}
SEXP stochSEIR_metadata(SEXP internal_p) {
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 19));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 19));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, R_NilValue);
  SET_VECTOR_ELT(variable_length, 1, R_NilValue);
  SET_VECTOR_ELT(variable_length, 2, R_NilValue);
  SET_VECTOR_ELT(variable_length, 3, R_NilValue);
  SET_VECTOR_ELT(variable_length, 4, R_NilValue);
  SET_VECTOR_ELT(variable_length, 5, R_NilValue);
  SET_VECTOR_ELT(variable_length, 6, R_NilValue);
  SET_VECTOR_ELT(variable_length, 7, R_NilValue);
  SET_VECTOR_ELT(variable_length, 8, R_NilValue);
  SET_VECTOR_ELT(variable_length, 9, R_NilValue);
  SET_VECTOR_ELT(variable_length, 10, R_NilValue);
  SET_VECTOR_ELT(variable_length, 11, R_NilValue);
  SET_VECTOR_ELT(variable_length, 12, R_NilValue);
  SET_VECTOR_ELT(variable_length, 13, R_NilValue);
  SET_VECTOR_ELT(variable_length, 14, R_NilValue);
  SET_VECTOR_ELT(variable_length, 15, R_NilValue);
  SET_VECTOR_ELT(variable_length, 16, R_NilValue);
  SET_VECTOR_ELT(variable_length, 17, R_NilValue);
  SET_VECTOR_ELT(variable_length, 18, R_NilValue);
  SET_STRING_ELT(variable_names, 0, mkChar("Sn"));
  SET_STRING_ELT(variable_names, 1, mkChar("Sj"));
  SET_STRING_ELT(variable_names, 2, mkChar("Sm"));
  SET_STRING_ELT(variable_names, 3, mkChar("Sf"));
  SET_STRING_ELT(variable_names, 4, mkChar("Ma"));
  SET_STRING_ELT(variable_names, 5, mkChar("En"));
  SET_STRING_ELT(variable_names, 6, mkChar("Ej"));
  SET_STRING_ELT(variable_names, 7, mkChar("Em"));
  SET_STRING_ELT(variable_names, 8, mkChar("Ef"));
  SET_STRING_ELT(variable_names, 9, mkChar("In"));
  SET_STRING_ELT(variable_names, 10, mkChar("Ij"));
  SET_STRING_ELT(variable_names, 11, mkChar("Im"));
  SET_STRING_ELT(variable_names, 12, mkChar("If"));
  SET_STRING_ELT(variable_names, 13, mkChar("Rn"));
  SET_STRING_ELT(variable_names, 14, mkChar("Rj"));
  SET_STRING_ELT(variable_names, 15, mkChar("Rm"));
  SET_STRING_ELT(variable_names, 16, mkChar("Rf"));
  SET_STRING_ELT(variable_names, 17, mkChar("timeOsc"));
  SET_STRING_ELT(variable_names, 18, mkChar("R0_out"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  UNPROTECT(2);
  return ret;
}
SEXP stochSEIR_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, 19));
  double * state = REAL(r_state);
  state[0] = internal->initial_Sn;
  state[1] = internal->initial_Sj;
  state[2] = internal->initial_Sm;
  state[3] = internal->initial_Sf;
  state[4] = internal->initial_Ma;
  state[5] = internal->initial_En;
  state[6] = internal->initial_Ej;
  state[7] = internal->initial_Em;
  state[8] = internal->initial_Ef;
  state[9] = internal->initial_In;
  state[10] = internal->initial_Ij;
  state[11] = internal->initial_Im;
  state[12] = internal->initial_If;
  state[13] = internal->initial_Rn;
  state[14] = internal->initial_Rj;
  state[15] = internal->initial_Rm;
  state[16] = internal->initial_Rf;
  state[17] = internal->initial_timeOsc;
  state[18] = internal->initial_R0_out;
  UNPROTECT(1);
  return r_state;
}
void stochSEIR_rhs(stochSEIR_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double timeOsc = state[17];
  double Sn = state[0];
  double En = state[5];
  double In = state[9];
  double Rn = state[13];
  double Ma = state[4];
  double Sj = state[1];
  double Ej = state[6];
  double Ij = state[10];
  double Rj = state[14];
  double Sm = state[2];
  double Em = state[7];
  double Im = state[11];
  double Rm = state[15];
  double Sf = state[3];
  double Ef = state[8];
  double If = state[12];
  double Rf = state[16];
  double N = Sn + Sj + Sm + Sf + En + Ej + Em + Ef + In + Ij + Im + If + Rn + Rj + Rm + Rf + Ma;
  double P_toE = (internal->beta_1 * (If + Im + Ij + In));
  state_next[17] = timeOsc + 1 / (double) internal->dt;
  double b = internal->c * exp(-(internal->s) * pow((cos(3.1415929999999999 * timeOsc - internal->phi)), 2));
  double P_death = internal->mj * (N / (double) internal->kappa);
  double P_deathA = internal->m * (N / (double) internal->kappa);
  double sDrive = (internal->envOscType == 1 ? internal->cV * exp(-(internal->sV) * pow((cos(3.1415929999999999 * timeOsc - internal->phiV)), 2)) : 1);
  double B_maPr = 1 - exp(-((internal->P_matWane + P_death)));
  double B_maSum = internal->P_matWane + P_death;
  double epsilon_ValS = (internal->epsilon_Val > 0 ? internal->epsilon_Val * sDrive : internal->epsilon_Val);
  double gamma_2_ValS = (internal->betaVer == 1 ? (internal->gamma_2_Val * sDrive) : internal->gamma_2_Val);
  double Ma_births = (internal->birthType == 1 ? (b * (Rf)) / (double) internal->dt : (b * (Rf + Ef)) / (double) internal->dt);
  double omega_2 = (internal->omega_2_Val > 0 ? (internal->omega_2_Val * sDrive) / (double) internal->dt : internal->omega_2_Val / (double) internal->dt);
  double Sn_births = (internal->birthType == 1 ? (b * (Sf + If + Ef)) / (double) internal->dt : (b * (Sf + If)) / (double) internal->dt);
  double B_maSumX = (B_maPr > 1 ? 1 : B_maPr);
  double beta_2x = (internal->betaFX == 0 ? internal->R0_Val * ((epsilon_ValS + internal->sigma_2_Val + internal->m_Val) * (gamma_2_ValS + internal->m_Val + internal->rho_Val) - epsilon_ValS * internal->rho_Val) / (double) (N * (epsilon_ValS + internal->sigma_2_Val + internal->m_Val)) : internal->betaFXVal);
  double epsilon = epsilon_ValS / (double) internal->dt;
  double gamma_2 = (internal->gammaVer == 2 ? gamma_2_ValS / (double) internal->dt : 0);
  double MAB = (Ma_births);
  double P_ImWane = omega_2;
  {
     int i = 1;
     internal->p4[i - 1] = internal->P_matWane / (double) B_maSum;
  }
  {
     int i = 2;
     internal->p4[i - 1] = P_death / (double) B_maSum;
  }
  double SNB = (Sn_births);
  double B_maSumBIN = Rf_rbinom(round(Ma), B_maSumX);
  double B_rfPr = 1 - exp(-((P_deathA + P_ImWane)));
  double B_rfSum = P_deathA + P_ImWane;
  double B_rjPr = 1 - exp(-((internal->P_J_A + P_death + P_ImWane)));
  double B_rjSum = internal->P_J_A + P_death + P_ImWane;
  double B_rmPr = 1 - exp(-((P_deathA + P_ImWane)));
  double B_rmSum = P_deathA + P_ImWane;
  double B_rnPr = 1 - exp(-((internal->P_matWane + P_death + P_ImWane)));
  double B_rnSum = internal->P_matWane + P_death + P_ImWane;
  double beta_2 = beta_2x / (double) internal->dt;
  double P_E_I = epsilon;
  double P_I_R = gamma_2;
  double B_efPr = 1 - exp(-((P_deathA + internal->P_E_S + internal->P_E_R + P_E_I)));
  double B_efSum = P_deathA + internal->P_E_S + internal->P_E_R + P_E_I;
  double B_ejPr = 1 - exp(-((internal->P_J_A + P_death + internal->P_E_S + internal->P_E_R + P_E_I)));
  double B_ejSum = internal->P_J_A + P_death + internal->P_E_S + internal->P_E_R + P_E_I;
  double B_emPr = 1 - exp(-((P_deathA + internal->P_E_S + internal->P_E_R + P_E_I)));
  double B_emSum = P_deathA + internal->P_E_S + internal->P_E_R + P_E_I;
  double B_enPr = 1 - exp(-((internal->P_matWane + P_death + internal->P_E_S + internal->P_E_R + P_E_I)));
  double B_enSum = (internal->P_matWane + P_death + internal->P_E_S + internal->P_E_R + P_E_I);
  double B_ifPr = 1 - exp(-((P_deathA + internal->P_I_S + P_I_R + internal->P_I_E)));
  double B_ifSum = P_deathA + internal->P_I_S + P_I_R + internal->P_I_E;
  double B_ijPr = 1 - exp(-((internal->P_J_A + P_death + internal->P_I_S + P_I_R + internal->P_I_E)));
  double B_ijSum = internal->P_J_A + P_death + internal->P_I_S + P_I_R + internal->P_I_E;
  double B_imSPr = 1 - exp(-((P_deathA + internal->P_I_S + P_I_R + internal->P_I_E)));
  double B_imSum = P_deathA + internal->P_I_S + P_I_R + internal->P_I_E;
  double B_inPr = 1 - exp(-((internal->P_matWane + P_death + internal->P_I_S + P_I_R + internal->P_I_E)));
  double B_inSum = internal->P_matWane + P_death + internal->P_I_S + P_I_R + internal->P_I_E;
  Rf_rmultinom(B_maSumBIN, internal->p4, internal->dim_p4, internal->B_ma);
  double B_rfSumX = (B_rfPr > 1 ? 1 : B_rfPr);
  double B_rjSumX = (B_rjPr > 1 ? 1 : B_rjPr);
  double B_rmSumX = (B_rmPr > 1 ? 1 : B_rmPr);
  double B_rnSumX = (B_rnPr > 1 ? 1 : B_rnPr);
  double P_toI = (beta_2 * (If + Im + Ij + In));
  {
     int i = 1;
     internal->p3[i - 1] = internal->P_matWane / (double) B_rnSum;
  }
  {
     int i = 2;
     internal->p3[i - 1] = P_death / (double) B_rnSum;
  }
  {
     int i = 3;
     internal->p3[i - 1] = P_ImWane / (double) B_rnSum;
  }
  {
     int i = 1;
     internal->pf3[i - 1] = P_deathA / (double) B_rfSum;
  }
  {
     int i = 2;
     internal->pf3[i - 1] = P_ImWane / (double) B_rfSum;
  }
  {
     int i = 1;
     internal->pj3[i - 1] = internal->P_J_A / (double) B_rjSum;
  }
  {
     int i = 2;
     internal->pj3[i - 1] = P_death / (double) B_rjSum;
  }
  {
     int i = 3;
     internal->pj3[i - 1] = P_ImWane / (double) B_rjSum;
  }
  {
     int i = 1;
     internal->pm3[i - 1] = P_deathA / (double) B_rmSum;
  }
  {
     int i = 2;
     internal->pm3[i - 1] = P_ImWane / (double) B_rmSum;
  }
  state_next[4] = ((Ma + MAB - B_maSumBIN) <= 0 ? 0 : (Ma + MAB - B_maSumBIN));
  state_next[18] = beta_2 * ((Sn + Sj + Sf + Sm) * (In + Ij + If + Im));
  double B_efSumX = (B_efPr > 1 ? 1 : B_efPr);
  double B_ejSumX = (B_ejPr > 1 ? 1 : B_ejPr);
  double B_emSumX = (B_emPr > 1 ? 1 : B_emPr);
  double B_enSumX = (B_enPr > 1 ? 1 : B_enPr);
  double B_ifSumX = (B_ifPr > 1 ? 1 : B_ifPr);
  double B_ijSumX = (B_ijPr > 1 ? 1 : B_ijPr);
  double B_imSumX = (B_imSPr > 1 ? 1 : B_imSPr);
  double B_inSumX = (B_inPr > 1 ? 1 : B_inPr);
  double B_rfSumBIN = Rf_rbinom(round((Rf)), B_rfSumX);
  double B_rjSumBIN = Rf_rbinom(round(Rj), B_rjSumX);
  double B_rmSumBIN = Rf_rbinom(round((Rm)), B_rmSumX);
  double B_RnSumBIN = Rf_rbinom(round(Rn), B_rnSumX);
  double B_sfPr = 1 - exp(-((P_deathA + P_toE + P_toI)));
  double B_sfSum = P_deathA + P_toE + P_toI;
  double B_sjPr = 1 - exp(-((internal->P_J_A + P_death + P_toE + P_toI)));
  double B_sjSum = internal->P_J_A + P_death + P_toE + P_toI;
  double B_smPr = 1 - exp(-((P_deathA + P_toE + P_toI)));
  double B_smSum = P_deathA + P_toE + P_toI;
  double B_snPr = 1 - exp(-((internal->P_matWane + P_death + P_toE + P_toI)));
  double B_snSum = internal->P_matWane + P_death + P_toE + P_toI;
  double n_Ma_Sj = internal->B_ma[0];
  {
     int i = 1;
     internal->p1[i - 1] = internal->P_matWane / (double) B_enSum;
  }
  {
     int i = 2;
     internal->p1[i - 1] = P_death / (double) B_enSum;
  }
  {
     int i = 3;
     internal->p1[i - 1] = internal->P_E_S / (double) B_enSum;
  }
  {
     int i = 4;
     internal->p1[i - 1] = internal->P_E_R / (double) B_enSum;
  }
  {
     int i = 5;
     internal->p1[i - 1] = P_E_I / (double) B_enSum;
  }
  {
     int i = 1;
     internal->p2[i - 1] = internal->P_matWane / (double) B_inSum;
  }
  {
     int i = 2;
     internal->p2[i - 1] = P_death / (double) B_inSum;
  }
  {
     int i = 3;
     internal->p2[i - 1] = internal->P_I_S / (double) B_inSum;
  }
  {
     int i = 4;
     internal->p2[i - 1] = P_I_R / (double) B_inSum;
  }
  {
     int i = 5;
     internal->p2[i - 1] = internal->P_I_E / (double) B_inSum;
  }
  {
     int i = 1;
     internal->pf1[i - 1] = P_deathA / (double) B_efSum;
  }
  {
     int i = 2;
     internal->pf1[i - 1] = internal->P_E_S / (double) B_efSum;
  }
  {
     int i = 3;
     internal->pf1[i - 1] = internal->P_E_R / (double) B_efSum;
  }
  {
     int i = 4;
     internal->pf1[i - 1] = P_E_I / (double) B_efSum;
  }
  {
     int i = 1;
     internal->pf2[i - 1] = P_deathA / (double) B_ifSum;
  }
  {
     int i = 2;
     internal->pf2[i - 1] = internal->P_I_S / (double) B_ifSum;
  }
  {
     int i = 3;
     internal->pf2[i - 1] = P_I_R / (double) B_ifSum;
  }
  {
     int i = 4;
     internal->pf2[i - 1] = internal->P_I_E / (double) B_ifSum;
  }
  {
     int i = 1;
     internal->pj1[i - 1] = internal->P_J_A / (double) B_ejSum;
  }
  {
     int i = 2;
     internal->pj1[i - 1] = P_death / (double) B_ejSum;
  }
  {
     int i = 3;
     internal->pj1[i - 1] = internal->P_E_S / (double) B_ejSum;
  }
  {
     int i = 4;
     internal->pj1[i - 1] = internal->P_E_R / (double) B_ejSum;
  }
  {
     int i = 5;
     internal->pj1[i - 1] = P_E_I / (double) B_ejSum;
  }
  {
     int i = 1;
     internal->pj2[i - 1] = internal->P_J_A / (double) B_ijSum;
  }
  {
     int i = 2;
     internal->pj2[i - 1] = P_death / (double) B_ijSum;
  }
  {
     int i = 3;
     internal->pj2[i - 1] = internal->P_I_S / (double) B_ijSum;
  }
  {
     int i = 4;
     internal->pj2[i - 1] = P_I_R / (double) B_ijSum;
  }
  {
     int i = 5;
     internal->pj2[i - 1] = internal->P_I_E / (double) B_ijSum;
  }
  {
     int i = 1;
     internal->pm1[i - 1] = P_deathA / (double) B_emSum;
  }
  {
     int i = 2;
     internal->pm1[i - 1] = internal->P_E_S / (double) B_emSum;
  }
  {
     int i = 3;
     internal->pm1[i - 1] = internal->P_E_R / (double) B_emSum;
  }
  {
     int i = 4;
     internal->pm1[i - 1] = P_E_I / (double) B_emSum;
  }
  {
     int i = 1;
     internal->pm2[i - 1] = P_deathA / (double) B_imSum;
  }
  {
     int i = 2;
     internal->pm2[i - 1] = internal->P_I_S / (double) B_imSum;
  }
  {
     int i = 3;
     internal->pm2[i - 1] = P_I_R / (double) B_imSum;
  }
  {
     int i = 4;
     internal->pm2[i - 1] = internal->P_I_E / (double) B_imSum;
  }
  double B_efSumBIN = Rf_rbinom(round((Ef)), B_efSumX);
  double B_ejSumBIN = Rf_rbinom(round(Ej), B_ejSumX);
  double B_emSumBIN = Rf_rbinom(round((Em)), B_emSumX);
  double B_enSumBIN = Rf_rbinom(round(En), B_enSumX);
  double B_ifSumBIN = Rf_rbinom(round((If)), B_ifSumX);
  double B_ijSumBIN = Rf_rbinom(round(Ij), B_ijSumX);
  double B_imSumBIN = Rf_rbinom(round((Im)), B_imSumX);
  double B_inSumBIN = Rf_rbinom(round(In), B_inSumX);
  Rf_rmultinom(B_rfSumBIN, internal->pf3, internal->dim_pf3, internal->B_rf);
  Rf_rmultinom(B_rjSumBIN, internal->pj3, internal->dim_pj3, internal->B_rj);
  Rf_rmultinom(B_rmSumBIN, internal->pm3, internal->dim_pm3, internal->B_rm);
  Rf_rmultinom(B_RnSumBIN, internal->p3, internal->dim_p3, internal->B_rn);
  double B_sfSumX = (B_sfPr > 1 ? 1 : B_sfPr);
  double B_sjSumX = (B_sjPr > 1 ? 1 : B_sjPr);
  double B_smSumX = (B_smPr > 1 ? 1 : B_smPr);
  double B_snSumX = (B_snPr > 1 ? 1 : B_snPr);
  {
     int i = 1;
     internal->p[i - 1] = internal->P_matWane / (double) B_snSum;
  }
  {
     int i = 2;
     internal->p[i - 1] = P_death / (double) B_snSum;
  }
  {
     int i = 3;
     internal->p[i - 1] = P_toE / (double) B_snSum;
  }
  {
     int i = 4;
     internal->p[i - 1] = P_toI / (double) B_snSum;
  }
  {
     int i = 1;
     internal->pf[i - 1] = P_deathA / (double) B_sfSum;
  }
  {
     int i = 2;
     internal->pf[i - 1] = P_toE / (double) B_sfSum;
  }
  {
     int i = 3;
     internal->pf[i - 1] = P_toI / (double) B_sfSum;
  }
  {
     int i = 1;
     internal->pj[i - 1] = internal->P_J_A / (double) B_sjSum;
  }
  {
     int i = 2;
     internal->pj[i - 1] = P_death / (double) B_sjSum;
  }
  {
     int i = 3;
     internal->pj[i - 1] = P_toE / (double) B_sjSum;
  }
  {
     int i = 4;
     internal->pj[i - 1] = P_toI / (double) B_sjSum;
  }
  {
     int i = 1;
     internal->pm[i - 1] = P_deathA / (double) B_smSum;
  }
  {
     int i = 2;
     internal->pm[i - 1] = P_toE / (double) B_smSum;
  }
  {
     int i = 3;
     internal->pm[i - 1] = P_toI / (double) B_smSum;
  }
  Rf_rmultinom(B_efSumBIN, internal->pf1, internal->dim_pf1, internal->B_ef);
  Rf_rmultinom(B_ejSumBIN, internal->pj1, internal->dim_pj1, internal->B_ej);
  Rf_rmultinom(B_emSumBIN, internal->pm1, internal->dim_pm1, internal->B_em);
  Rf_rmultinom(B_enSumBIN, internal->p1, internal->dim_p1, internal->B_en);
  Rf_rmultinom(B_ifSumBIN, internal->pf2, internal->dim_pf2, internal->B_if);
  Rf_rmultinom(B_ijSumBIN, internal->pj2, internal->dim_pj2, internal->B_ij);
  Rf_rmultinom(B_imSumBIN, internal->pm2, internal->dim_pm2, internal->B_im);
  Rf_rmultinom(B_inSumBIN, internal->p2, internal->dim_p2, internal->B_in);
  double B_sfSumBIN = Rf_rbinom(round((Sf)), B_sfSumX);
  double B_sjSumBIN = Rf_rbinom(round(Sj), B_sjSumX);
  double B_smSumBIN = Rf_rbinom(round((Sm)), B_smSumX);
  double B_snSumBIN = Rf_rbinom(round(Sn), B_snSumX);
  double n_Rf_Sf = internal->B_rf[1];
  double n_Rj_RmRf = internal->B_rj[0];
  double n_Rj_Sj = internal->B_rj[2];
  double n_Rm_Sm = internal->B_rm[1];
  double n_Rn_Rj = internal->B_rn[0];
  double n_Rn_Sn = internal->B_rn[2];
  Rf_rmultinom(B_sfSumBIN, internal->pf, internal->dim_pf, internal->B_sf);
  Rf_rmultinom(B_sjSumBIN, internal->pj, internal->dim_pj, internal->B_sj);
  Rf_rmultinom(B_smSumBIN, internal->pm, internal->dim_pm, internal->B_sm);
  Rf_rmultinom(B_snSumBIN, internal->p, internal->dim_p, internal->B_sn);
  double n_Ef_If = internal->B_ef[3];
  double n_Ef_Rf = (internal->sigmaVer == 2 ? internal->B_ef[1] + internal->B_ef[2] : 0);
  double n_Ef_Sf = (internal->sigmaVer == 1 ? internal->B_ef[1] + internal->B_ef[2] : 0);
  double n_Ej_EmEf = internal->B_ej[0];
  double n_Ej_Ij = internal->B_ej[4];
  double n_Ej_Rj = (internal->sigmaVer == 2 ? internal->B_ej[2] + internal->B_ej[3] : 0);
  double n_Ej_Sj = (internal->sigmaVer == 1 ? internal->B_ej[2] + internal->B_ej[3] : 0);
  double n_Em_Im = internal->B_em[3];
  double n_Em_Rm = (internal->sigmaVer == 2 ? internal->B_em[1] + internal->B_em[2] : 0);
  double n_Em_Sm = (internal->sigmaVer == 1 ? internal->B_em[1] + internal->B_em[2] : 0);
  double n_En_Ej = internal->B_en[0];
  double n_En_In = internal->B_en[4];
  double n_En_Rn = (internal->sigmaVer == 2 ? internal->B_en[2] + internal->B_en[3] : 0);
  double n_En_Sn = (internal->sigmaVer == 1 ? internal->B_en[2] + internal->B_en[3] : 0);
  double n_If_Ef = internal->B_if[3];
  double n_If_Rf = (internal->gammaVer == 2 ? internal->B_if[1] + internal->B_if[2] : 0);
  double n_If_Sf = (internal->gammaVer == 1 ? internal->B_if[1] + internal->B_if[2] : 0);
  double n_Ij_Ej = internal->B_ij[4];
  double n_Ij_ImIf = internal->B_ij[0];
  double n_Ij_Rj = (internal->gammaVer == 2 ? internal->B_ij[2] + internal->B_ij[3] : 0);
  double n_Ij_Sj = (internal->gammaVer == 1 ? internal->B_ij[2] + internal->B_ij[3] : 0);
  double n_Im_Em = internal->B_im[3];
  double n_Im_Rm = (internal->gammaVer == 2 ? internal->B_im[1] + internal->B_im[2] : 0);
  double n_Im_Sm = (internal->gammaVer == 1 ? internal->B_im[1] + internal->B_im[2] : 0);
  double n_In_En = internal->B_in[4];
  double n_In_Ij = internal->B_in[0];
  double n_In_Rn = (internal->gammaVer == 2 ? internal->B_in[2] + internal->B_in[3] : 0);
  double n_In_Sn = (internal->gammaVer == 1 ? internal->B_in[2] + internal->B_in[3] : 0);
  double n_Sf_If = internal->B_sf[1] + internal->B_sf[2];
  double n_Sj_Ij = internal->B_sj[2] + internal->B_sj[3];
  double n_Sj_SmSf = internal->B_sj[0];
  double n_Sm_Im = internal->B_sm[1] + internal->B_sm[2];
  double n_Sn_In = internal->B_sn[2] + internal->B_sn[3];
  double n_Sn_Sj = internal->B_sn[0];
  state_next[8] = ((Ef - B_efSumBIN + (n_Ej_EmEf / (double) 2) + internal->n_Sf_Ef + n_If_Ef) <= 0 ? 0 : (Ef - B_efSumBIN + (n_Ej_EmEf / (double) 2) + internal->n_Sf_Ef + n_If_Ef));
  state_next[6] = ((Ej - B_ejSumBIN + n_En_Ej + internal->n_Sj_Ej + n_Ij_Ej) <= 0 ? 0 : (Ej - B_ejSumBIN + n_En_Ej + internal->n_Sj_Ej + n_Ij_Ej));
  state_next[7] = ((Em - B_emSumBIN + (n_Ej_EmEf / (double) 2) + internal->n_Sm_Em + n_Im_Em) <= 0 ? 0 : (Em - B_emSumBIN + (n_Ej_EmEf / (double) 2) + internal->n_Sm_Em + n_Im_Em));
  state_next[5] = ((En - B_enSumBIN + internal->n_Sn_En + n_In_En) <= 0 ? 0 : (En - B_enSumBIN + internal->n_Sn_En + n_In_En));
  state_next[16] = ((Rf - B_rfSumBIN + (n_Rj_RmRf / (double) 2) + n_Ef_Rf + n_If_Rf) <= 0 ? 0 : (Rf - B_rfSumBIN + (n_Rj_RmRf / (double) 2) + n_Ef_Rf + n_If_Rf));
  state_next[14] = ((Rj - B_rjSumBIN + n_Rn_Rj + n_Ej_Rj + n_Ij_Rj) <= 0 ? 0 : (Rj - B_rjSumBIN + n_Rn_Rj + n_Ej_Rj + n_Ij_Rj));
  state_next[15] = ((Rm - B_rmSumBIN + (n_Rj_RmRf / (double) 2) + n_Em_Rm + n_Im_Rm) <= 0 ? 0 : (Rm - B_rmSumBIN + (n_Rj_RmRf / (double) 2) + n_Em_Rm + n_Im_Rm));
  state_next[13] = ((Rn - B_RnSumBIN + n_En_Rn + n_In_Rn) <= 0 ? 0 : (Rn - B_RnSumBIN + n_En_Rn + n_In_Rn));
  state_next[0] = ((Sn + SNB - B_snSumBIN + n_En_Sn + n_Rn_Sn + n_In_Sn) <= 0 ? 0 : (Sn + SNB - B_snSumBIN + n_En_Sn + n_Rn_Sn + n_In_Sn));
  state_next[12] = ((If - B_ifSumBIN + n_Sf_If + n_Ef_If + (0.5 * n_Ij_ImIf)) <= 1 ? 1 : (If - B_ifSumBIN + n_Sf_If + n_Ef_If + (0.5 * n_Ij_ImIf)));
  state_next[10] = ((Ij - B_ijSumBIN + n_In_Ij + n_Sj_Ij + n_Ej_Ij) <= 1 ? 1 : (Ij - B_ijSumBIN + n_In_Ij + n_Sj_Ij + n_Ej_Ij));
  state_next[11] = ((Im - B_imSumBIN + n_Sm_Im + n_Em_Im + (0.5 * n_Ij_ImIf)) <= 1 ? 1 : (Im - B_imSumBIN + n_Sm_Im + n_Em_Im + (0.5 * n_Ij_ImIf)));
  state_next[9] = ((In - B_inSumBIN + n_Sn_In + n_En_In) <= 1 ? 1 : (In - B_inSumBIN + n_Sn_In + n_En_In));
  state_next[3] = ((Sf - B_sfSumBIN + (n_Sj_SmSf / (double) 2) + n_Ef_Sf + n_If_Sf + n_Rf_Sf) <= 0 ? 0 : (Sf - B_sfSumBIN + (n_Sj_SmSf / (double) 2) + n_Ef_Sf + n_If_Sf + n_Rf_Sf));
  state_next[1] = ((Sj - B_sjSumBIN + n_Sn_Sj + n_Ma_Sj + n_Ej_Sj + n_Rj_Sj + n_Ij_Sj) <= 0 ? 0 : (Sj - B_sjSumBIN + n_Sn_Sj + n_Ma_Sj + n_Ej_Sj + n_Rj_Sj + n_Ij_Sj));
  state_next[2] = ((Sm - B_smSumBIN + (n_Sj_SmSf / (double) 2) + n_Em_Sm + n_Im_Sm + n_Rm_Sm) <= 0 ? 0 : (Sm - B_smSumBIN + (n_Sj_SmSf / (double) 2) + n_Em_Sm + n_Im_Sm + n_Rm_Sm));
}
void stochSEIR_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  stochSEIR_rhs((stochSEIR_internal*)internal, step, state, state_next, output);
}
SEXP stochSEIR_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  stochSEIR_internal *internal = stochSEIR_get_internal(internal_p, 1);
  double *output = NULL;
  GetRNGstate();
  stochSEIR_rhs(internal, INTEGER(step)[0], REAL(state), REAL(state_next), output);
  PutRNGstate();
  UNPROTECT(1);
  return state_next;
}
stochSEIRadInf_internal* stochSEIRadInf_get_internal(SEXP internal_p, int closed_error) {
  stochSEIRadInf_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (stochSEIRadInf_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void stochSEIRadInf_finalise(SEXP internal_p) {
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 0);
  if (internal_p) {
    Free(internal->B_ef);
    Free(internal->B_ej);
    Free(internal->B_em);
    Free(internal->B_en);
    Free(internal->B_if);
    Free(internal->B_im);
    Free(internal->B_ma);
    Free(internal->B_rf);
    Free(internal->B_rj);
    Free(internal->B_rm);
    Free(internal->B_rn);
    Free(internal->B_sf);
    Free(internal->B_sj);
    Free(internal->B_sm);
    Free(internal->B_sn);
    Free(internal->p);
    Free(internal->p1);
    Free(internal->p3);
    Free(internal->p4);
    Free(internal->pf);
    Free(internal->pf1);
    Free(internal->pf2);
    Free(internal->pf3);
    Free(internal->pj);
    Free(internal->pj1);
    Free(internal->pj3);
    Free(internal->pm);
    Free(internal->pm1);
    Free(internal->pm2);
    Free(internal->pm3);
    Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP stochSEIRadInf_create(SEXP user) {
  stochSEIRadInf_internal *internal = (stochSEIRadInf_internal*) Calloc(1, stochSEIRadInf_internal);
  internal->B_ef = NULL;
  internal->B_ej = NULL;
  internal->B_em = NULL;
  internal->B_en = NULL;
  internal->B_if = NULL;
  internal->B_im = NULL;
  internal->B_ma = NULL;
  internal->B_rf = NULL;
  internal->B_rj = NULL;
  internal->B_rm = NULL;
  internal->B_rn = NULL;
  internal->B_sf = NULL;
  internal->B_sj = NULL;
  internal->B_sm = NULL;
  internal->B_sn = NULL;
  internal->p = NULL;
  internal->p1 = NULL;
  internal->p3 = NULL;
  internal->p4 = NULL;
  internal->pf = NULL;
  internal->pf1 = NULL;
  internal->pf2 = NULL;
  internal->pf3 = NULL;
  internal->pj = NULL;
  internal->pj1 = NULL;
  internal->pj3 = NULL;
  internal->pm = NULL;
  internal->pm1 = NULL;
  internal->pm2 = NULL;
  internal->pm3 = NULL;
  internal->dim_B_ef = 4;
  internal->dim_B_ej = 4;
  internal->dim_B_em = 4;
  internal->dim_B_en = 4;
  internal->dim_B_if = 4;
  internal->dim_B_im = 4;
  internal->dim_B_ma = 2;
  internal->dim_B_rf = 2;
  internal->dim_B_rj = 3;
  internal->dim_B_rm = 2;
  internal->dim_B_rn = 3;
  internal->dim_B_sf = 3;
  internal->dim_B_sj = 4;
  internal->dim_B_sm = 3;
  internal->dim_B_sn = 4;
  internal->dim_p = 4;
  internal->dim_p1 = 4;
  internal->dim_p3 = 3;
  internal->dim_p4 = 2;
  internal->dim_pf = 3;
  internal->dim_pf1 = 4;
  internal->dim_pf2 = 4;
  internal->dim_pf3 = 2;
  internal->dim_pj = 4;
  internal->dim_pj1 = 4;
  internal->dim_pj3 = 3;
  internal->dim_pm = 3;
  internal->dim_pm1 = 4;
  internal->dim_pm2 = 4;
  internal->dim_pm3 = 2;
  internal->initial_timeOsc = 0;
  Free(internal->B_ef);
  internal->B_ef = (int*) Calloc(internal->dim_B_ef, int);
  Free(internal->B_ej);
  internal->B_ej = (int*) Calloc(internal->dim_B_ej, int);
  Free(internal->B_em);
  internal->B_em = (int*) Calloc(internal->dim_B_em, int);
  Free(internal->B_en);
  internal->B_en = (int*) Calloc(internal->dim_B_en, int);
  Free(internal->B_if);
  internal->B_if = (int*) Calloc(internal->dim_B_if, int);
  Free(internal->B_im);
  internal->B_im = (int*) Calloc(internal->dim_B_im, int);
  Free(internal->B_ma);
  internal->B_ma = (int*) Calloc(internal->dim_B_ma, int);
  Free(internal->B_rf);
  internal->B_rf = (int*) Calloc(internal->dim_B_rf, int);
  Free(internal->B_rj);
  internal->B_rj = (int*) Calloc(internal->dim_B_rj, int);
  Free(internal->B_rm);
  internal->B_rm = (int*) Calloc(internal->dim_B_rm, int);
  Free(internal->B_rn);
  internal->B_rn = (int*) Calloc(internal->dim_B_rn, int);
  Free(internal->B_sf);
  internal->B_sf = (int*) Calloc(internal->dim_B_sf, int);
  Free(internal->B_sj);
  internal->B_sj = (int*) Calloc(internal->dim_B_sj, int);
  Free(internal->B_sm);
  internal->B_sm = (int*) Calloc(internal->dim_B_sm, int);
  Free(internal->B_sn);
  internal->B_sn = (int*) Calloc(internal->dim_B_sn, int);
  Free(internal->p);
  internal->p = (double*) Calloc(internal->dim_p, double);
  Free(internal->p1);
  internal->p1 = (double*) Calloc(internal->dim_p1, double);
  Free(internal->p3);
  internal->p3 = (double*) Calloc(internal->dim_p3, double);
  Free(internal->p4);
  internal->p4 = (double*) Calloc(internal->dim_p4, double);
  Free(internal->pf);
  internal->pf = (double*) Calloc(internal->dim_pf, double);
  Free(internal->pf1);
  internal->pf1 = (double*) Calloc(internal->dim_pf1, double);
  Free(internal->pf2);
  internal->pf2 = (double*) Calloc(internal->dim_pf2, double);
  Free(internal->pf3);
  internal->pf3 = (double*) Calloc(internal->dim_pf3, double);
  Free(internal->pj);
  internal->pj = (double*) Calloc(internal->dim_pj, double);
  Free(internal->pj1);
  internal->pj1 = (double*) Calloc(internal->dim_pj1, double);
  Free(internal->pj3);
  internal->pj3 = (double*) Calloc(internal->dim_pj3, double);
  Free(internal->pm);
  internal->pm = (double*) Calloc(internal->dim_pm, double);
  Free(internal->pm1);
  internal->pm1 = (double*) Calloc(internal->dim_pm1, double);
  Free(internal->pm2);
  internal->pm2 = (double*) Calloc(internal->dim_pm2, double);
  Free(internal->pm3);
  internal->pm3 = (double*) Calloc(internal->dim_pm3, double);
  internal->betaVer = 0;
  internal->c_Val = 1.53;
  internal->dt = 365;
  internal->Ef_ini = 5;
  internal->Ej_ini = 5;
  internal->Em_ini = 5;
  internal->En_ini = 5;
  internal->epsilon_Val = 0.90000000000000002;
  internal->gamma_1_Val = 0.80000000000000004;
  internal->gamma_2_Val = 0;
  internal->gammaVer = 0;
  internal->If_ini = 0;
  internal->Im_ini = 0;
  internal->kappa_Val = 1000;
  internal->m_Val = 0.186;
  internal->Ma_ini = 0;
  internal->mj_Val = 0.79600000000000004;
  internal->mu_Val = 0.44;
  internal->omega_2_Val = 0.40000000000000002;
  internal->omega_m_Val = 0.40000000000000002;
  internal->phi_Val = 4.5;
  internal->R0_Val = 0.5;
  internal->Rf_ini = 0;
  internal->rho_Val = 0.90000000000000002;
  internal->Rj_ini = 0;
  internal->Rm_ini = 0;
  internal->Rn_ini = 0;
  internal->s_Val = 14.300000000000001;
  internal->Sf_ini = 20;
  internal->sigma_1_Val = 0.80000000000000004;
  internal->sigma_2_Val = 0;
  internal->sigmaVer = 0;
  internal->Sj_ini = 20;
  internal->Sm_ini = 20;
  internal->Sn_ini = 20;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, stochSEIRadInf_finalise);
  UNPROTECT(1);
  return ptr;
}
static stochSEIRadInf_internal *stochSEIRadInf_internal_ds;
void stochSEIRadInf_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  stochSEIRadInf_internal_ds = stochSEIRadInf_get_internal(get_desolve_gparms(), 1);
}
SEXP stochSEIRadInf_contents(SEXP internal_p) {
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 135));
  SEXP B_ef = PROTECT(allocVector(INTSXP, internal->dim_B_ef));
  memcpy(INTEGER(B_ef), internal->B_ef, internal->dim_B_ef * sizeof(int));
  SET_VECTOR_ELT(contents, 0, B_ef);
  SEXP B_ej = PROTECT(allocVector(INTSXP, internal->dim_B_ej));
  memcpy(INTEGER(B_ej), internal->B_ej, internal->dim_B_ej * sizeof(int));
  SET_VECTOR_ELT(contents, 1, B_ej);
  SEXP B_em = PROTECT(allocVector(INTSXP, internal->dim_B_em));
  memcpy(INTEGER(B_em), internal->B_em, internal->dim_B_em * sizeof(int));
  SET_VECTOR_ELT(contents, 2, B_em);
  SEXP B_en = PROTECT(allocVector(INTSXP, internal->dim_B_en));
  memcpy(INTEGER(B_en), internal->B_en, internal->dim_B_en * sizeof(int));
  SET_VECTOR_ELT(contents, 3, B_en);
  SEXP B_if = PROTECT(allocVector(INTSXP, internal->dim_B_if));
  memcpy(INTEGER(B_if), internal->B_if, internal->dim_B_if * sizeof(int));
  SET_VECTOR_ELT(contents, 4, B_if);
  SEXP B_im = PROTECT(allocVector(INTSXP, internal->dim_B_im));
  memcpy(INTEGER(B_im), internal->B_im, internal->dim_B_im * sizeof(int));
  SET_VECTOR_ELT(contents, 5, B_im);
  SEXP B_ma = PROTECT(allocVector(INTSXP, internal->dim_B_ma));
  memcpy(INTEGER(B_ma), internal->B_ma, internal->dim_B_ma * sizeof(int));
  SET_VECTOR_ELT(contents, 6, B_ma);
  SEXP B_rf = PROTECT(allocVector(INTSXP, internal->dim_B_rf));
  memcpy(INTEGER(B_rf), internal->B_rf, internal->dim_B_rf * sizeof(int));
  SET_VECTOR_ELT(contents, 7, B_rf);
  SEXP B_rj = PROTECT(allocVector(INTSXP, internal->dim_B_rj));
  memcpy(INTEGER(B_rj), internal->B_rj, internal->dim_B_rj * sizeof(int));
  SET_VECTOR_ELT(contents, 8, B_rj);
  SEXP B_rm = PROTECT(allocVector(INTSXP, internal->dim_B_rm));
  memcpy(INTEGER(B_rm), internal->B_rm, internal->dim_B_rm * sizeof(int));
  SET_VECTOR_ELT(contents, 9, B_rm);
  SEXP B_rn = PROTECT(allocVector(INTSXP, internal->dim_B_rn));
  memcpy(INTEGER(B_rn), internal->B_rn, internal->dim_B_rn * sizeof(int));
  SET_VECTOR_ELT(contents, 10, B_rn);
  SEXP B_sf = PROTECT(allocVector(INTSXP, internal->dim_B_sf));
  memcpy(INTEGER(B_sf), internal->B_sf, internal->dim_B_sf * sizeof(int));
  SET_VECTOR_ELT(contents, 11, B_sf);
  SEXP B_sj = PROTECT(allocVector(INTSXP, internal->dim_B_sj));
  memcpy(INTEGER(B_sj), internal->B_sj, internal->dim_B_sj * sizeof(int));
  SET_VECTOR_ELT(contents, 12, B_sj);
  SEXP B_sm = PROTECT(allocVector(INTSXP, internal->dim_B_sm));
  memcpy(INTEGER(B_sm), internal->B_sm, internal->dim_B_sm * sizeof(int));
  SET_VECTOR_ELT(contents, 13, B_sm);
  SEXP B_sn = PROTECT(allocVector(INTSXP, internal->dim_B_sn));
  memcpy(INTEGER(B_sn), internal->B_sn, internal->dim_B_sn * sizeof(int));
  SET_VECTOR_ELT(contents, 14, B_sn);
  SET_VECTOR_ELT(contents, 15, ScalarReal(internal->betaVer));
  SET_VECTOR_ELT(contents, 16, ScalarReal(internal->c));
  SET_VECTOR_ELT(contents, 17, ScalarReal(internal->c_Val));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_B_ef));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_B_ej));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_B_em));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_B_en));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_B_if));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_B_im));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_B_ma));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_B_rf));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_B_rj));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_B_rm));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_B_rn));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_B_sf));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_B_sj));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_B_sm));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_B_sn));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_p));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_p1));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_p3));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_p4));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_pf));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_pf1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_pf2));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_pf3));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_pj));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_pj1));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_pj3));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_pm));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_pm1));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_pm2));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_pm3));
  SET_VECTOR_ELT(contents, 48, ScalarReal(internal->dt));
  SET_VECTOR_ELT(contents, 49, ScalarReal(internal->Ef_ini));
  SET_VECTOR_ELT(contents, 50, ScalarReal(internal->Ej_ini));
  SET_VECTOR_ELT(contents, 51, ScalarReal(internal->Em_ini));
  SET_VECTOR_ELT(contents, 52, ScalarReal(internal->En_ini));
  SET_VECTOR_ELT(contents, 53, ScalarReal(internal->epsilon));
  SET_VECTOR_ELT(contents, 54, ScalarReal(internal->epsilon_Val));
  SET_VECTOR_ELT(contents, 55, ScalarReal(internal->gamma_1));
  SET_VECTOR_ELT(contents, 56, ScalarReal(internal->gamma_1_Val));
  SET_VECTOR_ELT(contents, 57, ScalarReal(internal->gamma_2));
  SET_VECTOR_ELT(contents, 58, ScalarReal(internal->gamma_2_Val));
  SET_VECTOR_ELT(contents, 59, ScalarReal(internal->gammaVer));
  SET_VECTOR_ELT(contents, 60, ScalarReal(internal->If_ini));
  SET_VECTOR_ELT(contents, 61, ScalarReal(internal->Im_ini));
  SET_VECTOR_ELT(contents, 62, ScalarReal(internal->initial_Ef));
  SET_VECTOR_ELT(contents, 63, ScalarReal(internal->initial_Ej));
  SET_VECTOR_ELT(contents, 64, ScalarReal(internal->initial_Em));
  SET_VECTOR_ELT(contents, 65, ScalarReal(internal->initial_En));
  SET_VECTOR_ELT(contents, 66, ScalarReal(internal->initial_If));
  SET_VECTOR_ELT(contents, 67, ScalarReal(internal->initial_Im));
  SET_VECTOR_ELT(contents, 68, ScalarReal(internal->initial_Ma));
  SET_VECTOR_ELT(contents, 69, ScalarReal(internal->initial_Rf));
  SET_VECTOR_ELT(contents, 70, ScalarReal(internal->initial_Rj));
  SET_VECTOR_ELT(contents, 71, ScalarReal(internal->initial_Rm));
  SET_VECTOR_ELT(contents, 72, ScalarReal(internal->initial_Rn));
  SET_VECTOR_ELT(contents, 73, ScalarReal(internal->initial_Sf));
  SET_VECTOR_ELT(contents, 74, ScalarReal(internal->initial_Sj));
  SET_VECTOR_ELT(contents, 75, ScalarReal(internal->initial_Sm));
  SET_VECTOR_ELT(contents, 76, ScalarReal(internal->initial_Sn));
  SET_VECTOR_ELT(contents, 77, ScalarReal(internal->initial_timeOsc));
  SET_VECTOR_ELT(contents, 78, ScalarReal(internal->kappa));
  SET_VECTOR_ELT(contents, 79, ScalarReal(internal->kappa_Val));
  SET_VECTOR_ELT(contents, 80, ScalarReal(internal->m));
  SET_VECTOR_ELT(contents, 81, ScalarReal(internal->m_Val));
  SET_VECTOR_ELT(contents, 82, ScalarReal(internal->Ma_ini));
  SET_VECTOR_ELT(contents, 83, ScalarReal(internal->mj));
  SET_VECTOR_ELT(contents, 84, ScalarReal(internal->mj_Val));
  SET_VECTOR_ELT(contents, 85, ScalarReal(internal->mu));
  SET_VECTOR_ELT(contents, 86, ScalarReal(internal->mu_Val));
  SET_VECTOR_ELT(contents, 87, ScalarReal(internal->omega_2));
  SET_VECTOR_ELT(contents, 88, ScalarReal(internal->omega_2_Val));
  SET_VECTOR_ELT(contents, 89, ScalarReal(internal->omega_m));
  SET_VECTOR_ELT(contents, 90, ScalarReal(internal->omega_m_Val));
  SEXP p = PROTECT(allocVector(REALSXP, internal->dim_p));
  memcpy(REAL(p), internal->p, internal->dim_p * sizeof(double));
  SET_VECTOR_ELT(contents, 91, p);
  SET_VECTOR_ELT(contents, 92, ScalarReal(internal->P_E_I));
  SET_VECTOR_ELT(contents, 93, ScalarReal(internal->P_E_R));
  SET_VECTOR_ELT(contents, 94, ScalarReal(internal->P_E_S));
  SET_VECTOR_ELT(contents, 95, ScalarReal(internal->P_I_E));
  SET_VECTOR_ELT(contents, 96, ScalarReal(internal->P_I_R));
  SET_VECTOR_ELT(contents, 97, ScalarReal(internal->P_I_S));
  SET_VECTOR_ELT(contents, 98, ScalarReal(internal->P_ImWane));
  SET_VECTOR_ELT(contents, 99, ScalarReal(internal->P_J_A));
  SET_VECTOR_ELT(contents, 100, ScalarReal(internal->P_matWane));
  SEXP p1 = PROTECT(allocVector(REALSXP, internal->dim_p1));
  memcpy(REAL(p1), internal->p1, internal->dim_p1 * sizeof(double));
  SET_VECTOR_ELT(contents, 101, p1);
  SEXP p3 = PROTECT(allocVector(REALSXP, internal->dim_p3));
  memcpy(REAL(p3), internal->p3, internal->dim_p3 * sizeof(double));
  SET_VECTOR_ELT(contents, 102, p3);
  SEXP p4 = PROTECT(allocVector(REALSXP, internal->dim_p4));
  memcpy(REAL(p4), internal->p4, internal->dim_p4 * sizeof(double));
  SET_VECTOR_ELT(contents, 103, p4);
  SEXP pf = PROTECT(allocVector(REALSXP, internal->dim_pf));
  memcpy(REAL(pf), internal->pf, internal->dim_pf * sizeof(double));
  SET_VECTOR_ELT(contents, 104, pf);
  SEXP pf1 = PROTECT(allocVector(REALSXP, internal->dim_pf1));
  memcpy(REAL(pf1), internal->pf1, internal->dim_pf1 * sizeof(double));
  SET_VECTOR_ELT(contents, 105, pf1);
  SEXP pf2 = PROTECT(allocVector(REALSXP, internal->dim_pf2));
  memcpy(REAL(pf2), internal->pf2, internal->dim_pf2 * sizeof(double));
  SET_VECTOR_ELT(contents, 106, pf2);
  SEXP pf3 = PROTECT(allocVector(REALSXP, internal->dim_pf3));
  memcpy(REAL(pf3), internal->pf3, internal->dim_pf3 * sizeof(double));
  SET_VECTOR_ELT(contents, 107, pf3);
  SET_VECTOR_ELT(contents, 108, ScalarReal(internal->phi));
  SET_VECTOR_ELT(contents, 109, ScalarReal(internal->phi_Val));
  SEXP pj = PROTECT(allocVector(REALSXP, internal->dim_pj));
  memcpy(REAL(pj), internal->pj, internal->dim_pj * sizeof(double));
  SET_VECTOR_ELT(contents, 110, pj);
  SEXP pj1 = PROTECT(allocVector(REALSXP, internal->dim_pj1));
  memcpy(REAL(pj1), internal->pj1, internal->dim_pj1 * sizeof(double));
  SET_VECTOR_ELT(contents, 111, pj1);
  SEXP pj3 = PROTECT(allocVector(REALSXP, internal->dim_pj3));
  memcpy(REAL(pj3), internal->pj3, internal->dim_pj3 * sizeof(double));
  SET_VECTOR_ELT(contents, 112, pj3);
  SEXP pm = PROTECT(allocVector(REALSXP, internal->dim_pm));
  memcpy(REAL(pm), internal->pm, internal->dim_pm * sizeof(double));
  SET_VECTOR_ELT(contents, 113, pm);
  SEXP pm1 = PROTECT(allocVector(REALSXP, internal->dim_pm1));
  memcpy(REAL(pm1), internal->pm1, internal->dim_pm1 * sizeof(double));
  SET_VECTOR_ELT(contents, 114, pm1);
  SEXP pm2 = PROTECT(allocVector(REALSXP, internal->dim_pm2));
  memcpy(REAL(pm2), internal->pm2, internal->dim_pm2 * sizeof(double));
  SET_VECTOR_ELT(contents, 115, pm2);
  SEXP pm3 = PROTECT(allocVector(REALSXP, internal->dim_pm3));
  memcpy(REAL(pm3), internal->pm3, internal->dim_pm3 * sizeof(double));
  SET_VECTOR_ELT(contents, 116, pm3);
  SET_VECTOR_ELT(contents, 117, ScalarReal(internal->R0_Val));
  SET_VECTOR_ELT(contents, 118, ScalarReal(internal->Rf_ini));
  SET_VECTOR_ELT(contents, 119, ScalarReal(internal->rho));
  SET_VECTOR_ELT(contents, 120, ScalarReal(internal->rho_Val));
  SET_VECTOR_ELT(contents, 121, ScalarReal(internal->Rj_ini));
  SET_VECTOR_ELT(contents, 122, ScalarReal(internal->Rm_ini));
  SET_VECTOR_ELT(contents, 123, ScalarReal(internal->Rn_ini));
  SET_VECTOR_ELT(contents, 124, ScalarReal(internal->s));
  SET_VECTOR_ELT(contents, 125, ScalarReal(internal->s_Val));
  SET_VECTOR_ELT(contents, 126, ScalarReal(internal->Sf_ini));
  SET_VECTOR_ELT(contents, 127, ScalarReal(internal->sigma_1));
  SET_VECTOR_ELT(contents, 128, ScalarReal(internal->sigma_1_Val));
  SET_VECTOR_ELT(contents, 129, ScalarReal(internal->sigma_2));
  SET_VECTOR_ELT(contents, 130, ScalarReal(internal->sigma_2_Val));
  SET_VECTOR_ELT(contents, 131, ScalarReal(internal->sigmaVer));
  SET_VECTOR_ELT(contents, 132, ScalarReal(internal->Sj_ini));
  SET_VECTOR_ELT(contents, 133, ScalarReal(internal->Sm_ini));
  SET_VECTOR_ELT(contents, 134, ScalarReal(internal->Sn_ini));
  SEXP nms = PROTECT(allocVector(STRSXP, 135));
  SET_STRING_ELT(nms, 0, mkChar("B_ef"));
  SET_STRING_ELT(nms, 1, mkChar("B_ej"));
  SET_STRING_ELT(nms, 2, mkChar("B_em"));
  SET_STRING_ELT(nms, 3, mkChar("B_en"));
  SET_STRING_ELT(nms, 4, mkChar("B_if"));
  SET_STRING_ELT(nms, 5, mkChar("B_im"));
  SET_STRING_ELT(nms, 6, mkChar("B_ma"));
  SET_STRING_ELT(nms, 7, mkChar("B_rf"));
  SET_STRING_ELT(nms, 8, mkChar("B_rj"));
  SET_STRING_ELT(nms, 9, mkChar("B_rm"));
  SET_STRING_ELT(nms, 10, mkChar("B_rn"));
  SET_STRING_ELT(nms, 11, mkChar("B_sf"));
  SET_STRING_ELT(nms, 12, mkChar("B_sj"));
  SET_STRING_ELT(nms, 13, mkChar("B_sm"));
  SET_STRING_ELT(nms, 14, mkChar("B_sn"));
  SET_STRING_ELT(nms, 15, mkChar("betaVer"));
  SET_STRING_ELT(nms, 16, mkChar("c"));
  SET_STRING_ELT(nms, 17, mkChar("c_Val"));
  SET_STRING_ELT(nms, 18, mkChar("dim_B_ef"));
  SET_STRING_ELT(nms, 19, mkChar("dim_B_ej"));
  SET_STRING_ELT(nms, 20, mkChar("dim_B_em"));
  SET_STRING_ELT(nms, 21, mkChar("dim_B_en"));
  SET_STRING_ELT(nms, 22, mkChar("dim_B_if"));
  SET_STRING_ELT(nms, 23, mkChar("dim_B_im"));
  SET_STRING_ELT(nms, 24, mkChar("dim_B_ma"));
  SET_STRING_ELT(nms, 25, mkChar("dim_B_rf"));
  SET_STRING_ELT(nms, 26, mkChar("dim_B_rj"));
  SET_STRING_ELT(nms, 27, mkChar("dim_B_rm"));
  SET_STRING_ELT(nms, 28, mkChar("dim_B_rn"));
  SET_STRING_ELT(nms, 29, mkChar("dim_B_sf"));
  SET_STRING_ELT(nms, 30, mkChar("dim_B_sj"));
  SET_STRING_ELT(nms, 31, mkChar("dim_B_sm"));
  SET_STRING_ELT(nms, 32, mkChar("dim_B_sn"));
  SET_STRING_ELT(nms, 33, mkChar("dim_p"));
  SET_STRING_ELT(nms, 34, mkChar("dim_p1"));
  SET_STRING_ELT(nms, 35, mkChar("dim_p3"));
  SET_STRING_ELT(nms, 36, mkChar("dim_p4"));
  SET_STRING_ELT(nms, 37, mkChar("dim_pf"));
  SET_STRING_ELT(nms, 38, mkChar("dim_pf1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_pf2"));
  SET_STRING_ELT(nms, 40, mkChar("dim_pf3"));
  SET_STRING_ELT(nms, 41, mkChar("dim_pj"));
  SET_STRING_ELT(nms, 42, mkChar("dim_pj1"));
  SET_STRING_ELT(nms, 43, mkChar("dim_pj3"));
  SET_STRING_ELT(nms, 44, mkChar("dim_pm"));
  SET_STRING_ELT(nms, 45, mkChar("dim_pm1"));
  SET_STRING_ELT(nms, 46, mkChar("dim_pm2"));
  SET_STRING_ELT(nms, 47, mkChar("dim_pm3"));
  SET_STRING_ELT(nms, 48, mkChar("dt"));
  SET_STRING_ELT(nms, 49, mkChar("Ef_ini"));
  SET_STRING_ELT(nms, 50, mkChar("Ej_ini"));
  SET_STRING_ELT(nms, 51, mkChar("Em_ini"));
  SET_STRING_ELT(nms, 52, mkChar("En_ini"));
  SET_STRING_ELT(nms, 53, mkChar("epsilon"));
  SET_STRING_ELT(nms, 54, mkChar("epsilon_Val"));
  SET_STRING_ELT(nms, 55, mkChar("gamma_1"));
  SET_STRING_ELT(nms, 56, mkChar("gamma_1_Val"));
  SET_STRING_ELT(nms, 57, mkChar("gamma_2"));
  SET_STRING_ELT(nms, 58, mkChar("gamma_2_Val"));
  SET_STRING_ELT(nms, 59, mkChar("gammaVer"));
  SET_STRING_ELT(nms, 60, mkChar("If_ini"));
  SET_STRING_ELT(nms, 61, mkChar("Im_ini"));
  SET_STRING_ELT(nms, 62, mkChar("initial_Ef"));
  SET_STRING_ELT(nms, 63, mkChar("initial_Ej"));
  SET_STRING_ELT(nms, 64, mkChar("initial_Em"));
  SET_STRING_ELT(nms, 65, mkChar("initial_En"));
  SET_STRING_ELT(nms, 66, mkChar("initial_If"));
  SET_STRING_ELT(nms, 67, mkChar("initial_Im"));
  SET_STRING_ELT(nms, 68, mkChar("initial_Ma"));
  SET_STRING_ELT(nms, 69, mkChar("initial_Rf"));
  SET_STRING_ELT(nms, 70, mkChar("initial_Rj"));
  SET_STRING_ELT(nms, 71, mkChar("initial_Rm"));
  SET_STRING_ELT(nms, 72, mkChar("initial_Rn"));
  SET_STRING_ELT(nms, 73, mkChar("initial_Sf"));
  SET_STRING_ELT(nms, 74, mkChar("initial_Sj"));
  SET_STRING_ELT(nms, 75, mkChar("initial_Sm"));
  SET_STRING_ELT(nms, 76, mkChar("initial_Sn"));
  SET_STRING_ELT(nms, 77, mkChar("initial_timeOsc"));
  SET_STRING_ELT(nms, 78, mkChar("kappa"));
  SET_STRING_ELT(nms, 79, mkChar("kappa_Val"));
  SET_STRING_ELT(nms, 80, mkChar("m"));
  SET_STRING_ELT(nms, 81, mkChar("m_Val"));
  SET_STRING_ELT(nms, 82, mkChar("Ma_ini"));
  SET_STRING_ELT(nms, 83, mkChar("mj"));
  SET_STRING_ELT(nms, 84, mkChar("mj_Val"));
  SET_STRING_ELT(nms, 85, mkChar("mu"));
  SET_STRING_ELT(nms, 86, mkChar("mu_Val"));
  SET_STRING_ELT(nms, 87, mkChar("omega_2"));
  SET_STRING_ELT(nms, 88, mkChar("omega_2_Val"));
  SET_STRING_ELT(nms, 89, mkChar("omega_m"));
  SET_STRING_ELT(nms, 90, mkChar("omega_m_Val"));
  SET_STRING_ELT(nms, 91, mkChar("p"));
  SET_STRING_ELT(nms, 92, mkChar("P_E_I"));
  SET_STRING_ELT(nms, 93, mkChar("P_E_R"));
  SET_STRING_ELT(nms, 94, mkChar("P_E_S"));
  SET_STRING_ELT(nms, 95, mkChar("P_I_E"));
  SET_STRING_ELT(nms, 96, mkChar("P_I_R"));
  SET_STRING_ELT(nms, 97, mkChar("P_I_S"));
  SET_STRING_ELT(nms, 98, mkChar("P_ImWane"));
  SET_STRING_ELT(nms, 99, mkChar("P_J_A"));
  SET_STRING_ELT(nms, 100, mkChar("P_matWane"));
  SET_STRING_ELT(nms, 101, mkChar("p1"));
  SET_STRING_ELT(nms, 102, mkChar("p3"));
  SET_STRING_ELT(nms, 103, mkChar("p4"));
  SET_STRING_ELT(nms, 104, mkChar("pf"));
  SET_STRING_ELT(nms, 105, mkChar("pf1"));
  SET_STRING_ELT(nms, 106, mkChar("pf2"));
  SET_STRING_ELT(nms, 107, mkChar("pf3"));
  SET_STRING_ELT(nms, 108, mkChar("phi"));
  SET_STRING_ELT(nms, 109, mkChar("phi_Val"));
  SET_STRING_ELT(nms, 110, mkChar("pj"));
  SET_STRING_ELT(nms, 111, mkChar("pj1"));
  SET_STRING_ELT(nms, 112, mkChar("pj3"));
  SET_STRING_ELT(nms, 113, mkChar("pm"));
  SET_STRING_ELT(nms, 114, mkChar("pm1"));
  SET_STRING_ELT(nms, 115, mkChar("pm2"));
  SET_STRING_ELT(nms, 116, mkChar("pm3"));
  SET_STRING_ELT(nms, 117, mkChar("R0_Val"));
  SET_STRING_ELT(nms, 118, mkChar("Rf_ini"));
  SET_STRING_ELT(nms, 119, mkChar("rho"));
  SET_STRING_ELT(nms, 120, mkChar("rho_Val"));
  SET_STRING_ELT(nms, 121, mkChar("Rj_ini"));
  SET_STRING_ELT(nms, 122, mkChar("Rm_ini"));
  SET_STRING_ELT(nms, 123, mkChar("Rn_ini"));
  SET_STRING_ELT(nms, 124, mkChar("s"));
  SET_STRING_ELT(nms, 125, mkChar("s_Val"));
  SET_STRING_ELT(nms, 126, mkChar("Sf_ini"));
  SET_STRING_ELT(nms, 127, mkChar("sigma_1"));
  SET_STRING_ELT(nms, 128, mkChar("sigma_1_Val"));
  SET_STRING_ELT(nms, 129, mkChar("sigma_2"));
  SET_STRING_ELT(nms, 130, mkChar("sigma_2_Val"));
  SET_STRING_ELT(nms, 131, mkChar("sigmaVer"));
  SET_STRING_ELT(nms, 132, mkChar("Sj_ini"));
  SET_STRING_ELT(nms, 133, mkChar("Sm_ini"));
  SET_STRING_ELT(nms, 134, mkChar("Sn_ini"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(32);
  return contents;
}
SEXP stochSEIRadInf_set_user(SEXP internal_p, SEXP user) {
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 1);
  internal->betaVer = user_get_scalar_double(user, "betaVer", internal->betaVer, NA_REAL, NA_REAL);
  internal->c_Val = user_get_scalar_double(user, "c_Val", internal->c_Val, NA_REAL, NA_REAL);
  internal->dt = user_get_scalar_double(user, "dt", internal->dt, NA_REAL, NA_REAL);
  internal->Ef_ini = user_get_scalar_double(user, "Ef_ini", internal->Ef_ini, NA_REAL, NA_REAL);
  internal->Ej_ini = user_get_scalar_double(user, "Ej_ini", internal->Ej_ini, NA_REAL, NA_REAL);
  internal->Em_ini = user_get_scalar_double(user, "Em_ini", internal->Em_ini, NA_REAL, NA_REAL);
  internal->En_ini = user_get_scalar_double(user, "En_ini", internal->En_ini, NA_REAL, NA_REAL);
  internal->epsilon_Val = user_get_scalar_double(user, "epsilon_Val", internal->epsilon_Val, NA_REAL, NA_REAL);
  internal->gamma_1_Val = user_get_scalar_double(user, "gamma_1_Val", internal->gamma_1_Val, NA_REAL, NA_REAL);
  internal->gamma_2_Val = user_get_scalar_double(user, "gamma_2_Val", internal->gamma_2_Val, NA_REAL, NA_REAL);
  internal->gammaVer = user_get_scalar_double(user, "gammaVer", internal->gammaVer, NA_REAL, NA_REAL);
  internal->If_ini = user_get_scalar_double(user, "If_ini", internal->If_ini, NA_REAL, NA_REAL);
  internal->Im_ini = user_get_scalar_double(user, "Im_ini", internal->Im_ini, NA_REAL, NA_REAL);
  internal->kappa_Val = user_get_scalar_double(user, "kappa_Val", internal->kappa_Val, NA_REAL, NA_REAL);
  internal->m_Val = user_get_scalar_double(user, "m_Val", internal->m_Val, NA_REAL, NA_REAL);
  internal->Ma_ini = user_get_scalar_double(user, "Ma_ini", internal->Ma_ini, NA_REAL, NA_REAL);
  internal->mj_Val = user_get_scalar_double(user, "mj_Val", internal->mj_Val, NA_REAL, NA_REAL);
  internal->mu_Val = user_get_scalar_double(user, "mu_Val", internal->mu_Val, NA_REAL, NA_REAL);
  internal->omega_2_Val = user_get_scalar_double(user, "omega_2_Val", internal->omega_2_Val, NA_REAL, NA_REAL);
  internal->omega_m_Val = user_get_scalar_double(user, "omega_m_Val", internal->omega_m_Val, NA_REAL, NA_REAL);
  internal->phi_Val = user_get_scalar_double(user, "phi_Val", internal->phi_Val, NA_REAL, NA_REAL);
  internal->R0_Val = user_get_scalar_double(user, "R0_Val", internal->R0_Val, NA_REAL, NA_REAL);
  internal->Rf_ini = user_get_scalar_double(user, "Rf_ini", internal->Rf_ini, NA_REAL, NA_REAL);
  internal->rho_Val = user_get_scalar_double(user, "rho_Val", internal->rho_Val, NA_REAL, NA_REAL);
  internal->Rj_ini = user_get_scalar_double(user, "Rj_ini", internal->Rj_ini, NA_REAL, NA_REAL);
  internal->Rm_ini = user_get_scalar_double(user, "Rm_ini", internal->Rm_ini, NA_REAL, NA_REAL);
  internal->Rn_ini = user_get_scalar_double(user, "Rn_ini", internal->Rn_ini, NA_REAL, NA_REAL);
  internal->s_Val = user_get_scalar_double(user, "s_Val", internal->s_Val, NA_REAL, NA_REAL);
  internal->Sf_ini = user_get_scalar_double(user, "Sf_ini", internal->Sf_ini, NA_REAL, NA_REAL);
  internal->sigma_1_Val = user_get_scalar_double(user, "sigma_1_Val", internal->sigma_1_Val, NA_REAL, NA_REAL);
  internal->sigma_2_Val = user_get_scalar_double(user, "sigma_2_Val", internal->sigma_2_Val, NA_REAL, NA_REAL);
  internal->sigmaVer = user_get_scalar_double(user, "sigmaVer", internal->sigmaVer, NA_REAL, NA_REAL);
  internal->Sj_ini = user_get_scalar_double(user, "Sj_ini", internal->Sj_ini, NA_REAL, NA_REAL);
  internal->Sm_ini = user_get_scalar_double(user, "Sm_ini", internal->Sm_ini, NA_REAL, NA_REAL);
  internal->Sn_ini = user_get_scalar_double(user, "Sn_ini", internal->Sn_ini, NA_REAL, NA_REAL);
  internal->c = internal->c_Val;
  internal->epsilon = internal->epsilon_Val;
  internal->gamma_1 = (internal->gammaVer == 1 ? internal->gamma_1_Val : 0);
  internal->gamma_2 = (internal->gammaVer == 2 ? internal->gamma_2_Val : 0);
  internal->initial_Ef = internal->Ef_ini;
  internal->initial_Ej = internal->Ej_ini;
  internal->initial_Em = internal->Em_ini;
  internal->initial_En = internal->En_ini;
  internal->initial_If = internal->If_ini;
  internal->initial_Im = internal->Im_ini;
  internal->initial_Ma = internal->Ma_ini;
  internal->initial_Rf = internal->Rf_ini;
  internal->initial_Rj = internal->Rj_ini;
  internal->initial_Rm = internal->Rm_ini;
  internal->initial_Rn = internal->Rn_ini;
  internal->initial_Sf = internal->Sf_ini;
  internal->initial_Sj = internal->Sj_ini;
  internal->initial_Sm = internal->Sm_ini;
  internal->initial_Sn = internal->Sn_ini;
  internal->kappa = internal->kappa_Val;
  internal->m = internal->m_Val;
  internal->mj = internal->mj_Val;
  internal->mu = internal->mu_Val;
  internal->omega_2 = internal->omega_2_Val;
  internal->omega_m = internal->omega_m_Val;
  internal->phi = internal->phi_Val;
  internal->rho = internal->rho_Val;
  internal->s = internal->s_Val;
  internal->sigma_1 = (internal->sigmaVer == 1 ? internal->sigma_1_Val : 0);
  internal->sigma_2 = (internal->sigmaVer == 2 ? internal->sigma_2_Val : 0);
  internal->P_E_I = (1 - exp(-((internal->epsilon / (double) internal->dt))));
  internal->P_E_R = (1 - exp(-((internal->sigma_2 / (double) internal->dt))));
  internal->P_E_S = (1 - exp(-((internal->sigma_1 / (double) internal->dt))));
  internal->P_I_E = (1 - exp(-((internal->rho / (double) internal->dt))));
  internal->P_I_R = (1 - exp(-((internal->gamma_2 / (double) internal->dt))));
  internal->P_I_S = (1 - exp(-((internal->gamma_1 / (double) internal->dt))));
  internal->P_ImWane = (1 - exp(-((internal->omega_2 / (double) internal->dt))));
  internal->P_J_A = (1 - exp(-((internal->mu / (double) internal->dt))));
  internal->P_matWane = (1 - exp(-((internal->omega_m / (double) internal->dt))));
  return R_NilValue;
}
SEXP stochSEIRadInf_metadata(SEXP internal_p) {
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 16));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 16));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, R_NilValue);
  SET_VECTOR_ELT(variable_length, 1, R_NilValue);
  SET_VECTOR_ELT(variable_length, 2, R_NilValue);
  SET_VECTOR_ELT(variable_length, 3, R_NilValue);
  SET_VECTOR_ELT(variable_length, 4, R_NilValue);
  SET_VECTOR_ELT(variable_length, 5, R_NilValue);
  SET_VECTOR_ELT(variable_length, 6, R_NilValue);
  SET_VECTOR_ELT(variable_length, 7, R_NilValue);
  SET_VECTOR_ELT(variable_length, 8, R_NilValue);
  SET_VECTOR_ELT(variable_length, 9, R_NilValue);
  SET_VECTOR_ELT(variable_length, 10, R_NilValue);
  SET_VECTOR_ELT(variable_length, 11, R_NilValue);
  SET_VECTOR_ELT(variable_length, 12, R_NilValue);
  SET_VECTOR_ELT(variable_length, 13, R_NilValue);
  SET_VECTOR_ELT(variable_length, 14, R_NilValue);
  SET_VECTOR_ELT(variable_length, 15, R_NilValue);
  SET_STRING_ELT(variable_names, 0, mkChar("Sn"));
  SET_STRING_ELT(variable_names, 1, mkChar("Sj"));
  SET_STRING_ELT(variable_names, 2, mkChar("Sm"));
  SET_STRING_ELT(variable_names, 3, mkChar("Sf"));
  SET_STRING_ELT(variable_names, 4, mkChar("Ma"));
  SET_STRING_ELT(variable_names, 5, mkChar("En"));
  SET_STRING_ELT(variable_names, 6, mkChar("Ej"));
  SET_STRING_ELT(variable_names, 7, mkChar("Em"));
  SET_STRING_ELT(variable_names, 8, mkChar("Ef"));
  SET_STRING_ELT(variable_names, 9, mkChar("Im"));
  SET_STRING_ELT(variable_names, 10, mkChar("If"));
  SET_STRING_ELT(variable_names, 11, mkChar("Rn"));
  SET_STRING_ELT(variable_names, 12, mkChar("Rj"));
  SET_STRING_ELT(variable_names, 13, mkChar("Rm"));
  SET_STRING_ELT(variable_names, 14, mkChar("Rf"));
  SET_STRING_ELT(variable_names, 15, mkChar("timeOsc"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  UNPROTECT(2);
  return ret;
}
SEXP stochSEIRadInf_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, 16));
  double * state = REAL(r_state);
  state[0] = internal->initial_Sn;
  state[1] = internal->initial_Sj;
  state[2] = internal->initial_Sm;
  state[3] = internal->initial_Sf;
  state[4] = internal->initial_Ma;
  state[5] = internal->initial_En;
  state[6] = internal->initial_Ej;
  state[7] = internal->initial_Em;
  state[8] = internal->initial_Ef;
  state[9] = internal->initial_Im;
  state[10] = internal->initial_If;
  state[11] = internal->initial_Rn;
  state[12] = internal->initial_Rj;
  state[13] = internal->initial_Rm;
  state[14] = internal->initial_Rf;
  state[15] = internal->initial_timeOsc;
  UNPROTECT(1);
  return r_state;
}
void stochSEIRadInf_rhs(stochSEIRadInf_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double timeOsc = state[15];
  double Sn = state[0];
  double En = state[5];
  double Rn = state[11];
  double Ma = state[4];
  double Sj = state[1];
  double Ej = state[6];
  double Rj = state[12];
  double Sm = state[2];
  double Em = state[7];
  double Im = state[9];
  double Rm = state[13];
  double Sf = state[3];
  double Ef = state[8];
  double If = state[10];
  double Rf = state[14];
  double MaL = (Ma > 0 ? Ma : 1);
  double N = Sn + Sj + Sm + Sf + En + Ej + Em + Ef + Im + If + Rn + Rj + Rm + Rf + Ma;
  state_next[15] = timeOsc + 1 / (double) internal->dt;
  double b = internal->c * exp(-(internal->s) * pow((cos(3.1415929999999999 * timeOsc - internal->phi)), 2));
  double beta_Val = ((internal->R0_Val * ((pow(internal->m_Val, 2)) + (internal->rho_Val * internal->m_Val) + (internal->sigma_2_Val * internal->m_Val) + (internal->m_Val * internal->gamma_1_Val) + (internal->m_Val * internal->gamma_2_Val) + (internal->m_Val * internal->sigma_2_Val) + (internal->m_Val * internal->epsilon_Val) + (internal->rho_Val * internal->sigma_2_Val) + (internal->sigma_2_Val * internal->gamma_1_Val) + (internal->sigma_2_Val * internal->gamma_2_Val) + (internal->rho_Val * internal->sigma_1_Val) + (internal->gamma_1_Val * internal->sigma_1_Val) + (internal->gamma_2_Val * internal->sigma_1_Val) + (internal->gamma_1_Val * internal->epsilon_Val) + (internal->gamma_2_Val * internal->epsilon_Val)) / (double) (N * internal->epsilon_Val)));
  double beta_Val2 = internal->R0_Val * ((internal->epsilon_Val + (internal->sigma_1_Val + internal->sigma_2_Val) + internal->m_Val) * ((internal->gamma_1_Val + internal->gamma_2_Val) + internal->m_Val + internal->rho_Val) - internal->epsilon_Val * internal->rho_Val) / (double) (N * internal->epsilon_Val + (internal->sigma_1_Val + internal->sigma_2_Val) + internal->m_Val);
  double P_death = (1 - exp(-((internal->mj * (N / (double) internal->kappa))) / (double) internal->dt));
  double P_deathA = (1 - exp(-((internal->m * (N / (double) internal->kappa))) / (double) internal->dt));
  double B_efSum = P_deathA + internal->P_E_S + internal->P_E_R + internal->P_E_I;
  double B_ejSum = internal->P_J_A + P_death + internal->P_E_S + internal->P_E_R;
  double B_emSum = P_deathA + internal->P_E_S + internal->P_E_R + internal->P_E_I;
  double B_enSum = (internal->P_matWane + P_death + internal->P_E_S + internal->P_E_R);
  double B_ifSum = P_deathA + internal->P_I_S + internal->P_I_R + internal->P_I_E;
  double B_imSum = P_deathA + internal->P_I_S + internal->P_I_R + internal->P_I_E;
  double B_maSum = internal->P_matWane + P_death;
  double B_rfSum = P_deathA + internal->P_ImWane;
  double B_rjSum = internal->P_J_A + P_death + internal->P_ImWane;
  double B_rmSum = P_deathA + internal->P_ImWane;
  double B_rnSum = internal->P_matWane + P_death + internal->P_ImWane;
  double beta_1 = (internal->betaVer == 1 ? beta_Val : 0);
  double beta_2 = (internal->betaVer == 2 ? beta_Val2 : 0);
  double Ma_births = (2 * b * Rf) / (double) internal->dt;
  double Sn_births = (2 * b * (Sf + Ef + If)) / (double) internal->dt;
  double B_efSumBIN = Rf_rbinom(round(Ef), B_efSum);
  double B_ejSumBIN = Rf_rbinom(round(Ej), B_ejSum);
  double B_emSumBIN = Rf_rbinom(round(Em), B_emSum);
  double B_enSumBIN = Rf_rbinom(round(En), B_enSum);
  double B_ifSumBIN = Rf_rbinom(round(If), B_ifSum);
  double B_imSumBIN = Rf_rbinom(round(Im), B_imSum);
  double B_maSumBIN = Rf_rbinom(round(MaL), B_maSum);
  double B_rfSumBIN = Rf_rbinom(round(Rf), B_rfSum);
  double B_rjSumBIN = Rf_rbinom(round(Rj), B_rjSum);
  double B_rmSumBIN = Rf_rbinom(round(Rm), B_rmSum);
  double B_RnSumBIN = Rf_rbinom(round(Rn), B_rnSum);
  double MAB = Rf_rpois(Ma_births);
  double P_toE = (1 - exp(-(((beta_1 * (If + Im) / (double) N) / (double) internal->dt))));
  double P_toI = (1 - exp(-(((beta_2 * (If + Im) / (double) N) / (double) internal->dt))));
  {
     int i = 1;
     internal->p1[i - 1] = internal->P_matWane / (double) B_enSum;
  }
  {
     int i = 2;
     internal->p1[i - 1] = P_death / (double) B_enSum;
  }
  {
     int i = 3;
     internal->p1[i - 1] = internal->P_E_S / (double) B_enSum;
  }
  {
     int i = 4;
     internal->p1[i - 1] = internal->P_E_R / (double) B_enSum;
  }
  {
     int i = 1;
     internal->p3[i - 1] = internal->P_matWane / (double) B_rnSum;
  }
  {
     int i = 2;
     internal->p3[i - 1] = P_death / (double) B_rnSum;
  }
  {
     int i = 3;
     internal->p3[i - 1] = internal->P_ImWane / (double) B_rnSum;
  }
  {
     int i = 1;
     internal->p4[i - 1] = internal->P_matWane / (double) B_maSum;
  }
  {
     int i = 2;
     internal->p4[i - 1] = P_death / (double) B_maSum;
  }
  {
     int i = 1;
     internal->pf1[i - 1] = P_deathA / (double) B_efSum;
  }
  {
     int i = 2;
     internal->pf1[i - 1] = internal->P_E_S / (double) B_efSum;
  }
  {
     int i = 3;
     internal->pf1[i - 1] = internal->P_E_R / (double) B_efSum;
  }
  {
     int i = 4;
     internal->pf1[i - 1] = internal->P_E_I / (double) B_efSum;
  }
  {
     int i = 1;
     internal->pf2[i - 1] = P_deathA / (double) B_ifSum;
  }
  {
     int i = 2;
     internal->pf2[i - 1] = internal->P_I_S / (double) B_ifSum;
  }
  {
     int i = 3;
     internal->pf2[i - 1] = internal->P_I_R / (double) B_ifSum;
  }
  {
     int i = 4;
     internal->pf2[i - 1] = internal->P_I_E / (double) B_ifSum;
  }
  {
     int i = 1;
     internal->pf3[i - 1] = P_deathA / (double) B_rfSum;
  }
  {
     int i = 2;
     internal->pf3[i - 1] = internal->P_ImWane / (double) B_rfSum;
  }
  {
     int i = 1;
     internal->pj1[i - 1] = internal->P_J_A / (double) B_ejSum;
  }
  {
     int i = 2;
     internal->pj1[i - 1] = P_death / (double) B_ejSum;
  }
  {
     int i = 3;
     internal->pj1[i - 1] = internal->P_E_S / (double) B_ejSum;
  }
  {
     int i = 4;
     internal->pj1[i - 1] = internal->P_E_R / (double) B_ejSum;
  }
  {
     int i = 1;
     internal->pj3[i - 1] = internal->P_J_A / (double) B_rjSum;
  }
  {
     int i = 2;
     internal->pj3[i - 1] = P_death / (double) B_rjSum;
  }
  {
     int i = 3;
     internal->pj3[i - 1] = internal->P_ImWane / (double) B_rjSum;
  }
  {
     int i = 1;
     internal->pm1[i - 1] = P_deathA / (double) B_emSum;
  }
  {
     int i = 2;
     internal->pm1[i - 1] = internal->P_E_S / (double) B_emSum;
  }
  {
     int i = 3;
     internal->pm1[i - 1] = internal->P_E_R / (double) B_emSum;
  }
  {
     int i = 4;
     internal->pm1[i - 1] = internal->P_E_I / (double) B_emSum;
  }
  {
     int i = 1;
     internal->pm2[i - 1] = P_deathA / (double) B_imSum;
  }
  {
     int i = 2;
     internal->pm2[i - 1] = internal->P_I_S / (double) B_imSum;
  }
  {
     int i = 3;
     internal->pm2[i - 1] = internal->P_I_R / (double) B_imSum;
  }
  {
     int i = 4;
     internal->pm2[i - 1] = internal->P_I_E / (double) B_imSum;
  }
  {
     int i = 1;
     internal->pm3[i - 1] = P_deathA / (double) B_rmSum;
  }
  {
     int i = 2;
     internal->pm3[i - 1] = internal->P_ImWane / (double) B_rmSum;
  }
  double SNB = Rf_rpois(Sn_births);
  Rf_rmultinom(B_efSumBIN, internal->pf1, internal->dim_pf1, internal->B_ef);
  Rf_rmultinom(B_ejSumBIN, internal->pj1, internal->dim_pj1, internal->B_ej);
  Rf_rmultinom(B_emSumBIN, internal->pm1, internal->dim_pm1, internal->B_em);
  Rf_rmultinom(B_enSumBIN, internal->p1, internal->dim_p1, internal->B_en);
  Rf_rmultinom(B_ifSumBIN, internal->pf2, internal->dim_pf2, internal->B_if);
  Rf_rmultinom(B_imSumBIN, internal->pm2, internal->dim_pm2, internal->B_im);
  Rf_rmultinom(B_maSumBIN, internal->p4, internal->dim_p4, internal->B_ma);
  Rf_rmultinom(B_rfSumBIN, internal->pf3, internal->dim_pf3, internal->B_rf);
  Rf_rmultinom(B_rjSumBIN, internal->pj3, internal->dim_pj3, internal->B_rj);
  Rf_rmultinom(B_rmSumBIN, internal->pm3, internal->dim_pm3, internal->B_rm);
  Rf_rmultinom(B_RnSumBIN, internal->p3, internal->dim_p3, internal->B_rn);
  double B_sfSum = P_deathA + P_toE + P_toI;
  double B_sjSum = internal->P_J_A + P_death + P_toE + P_toI;
  double B_smSum = P_deathA + P_toE + P_toI;
  double B_snSum = internal->P_matWane + P_death + P_toE + P_toI;
  double B_sfSumBIN = Rf_rbinom(round(Sf), B_sfSum);
  double B_sjSumBIN = Rf_rbinom(round(Sj), B_sjSum);
  double B_smSumBIN = Rf_rbinom(round(Sm), B_smSum);
  double B_snSumBIN = Rf_rbinom(round(Sn), B_snSum);
  double n_Ef_If = internal->B_ef[3];
  double n_Ef_Rf = (internal->sigmaVer == 2 ? internal->B_ef[1] + internal->B_ef[2] : 0);
  double n_Ef_Sf = (internal->sigmaVer == 1 ? internal->B_ef[1] + internal->B_ef[2] : 0);
  double n_Ej_EmEf = internal->B_ej[0];
  double n_Ej_Rj = (internal->sigmaVer == 2 ? internal->B_ej[2] + internal->B_ej[3] : 0);
  double n_Ej_Sj = (internal->sigmaVer == 1 ? internal->B_ej[2] + internal->B_ej[3] : 0);
  double n_Em_Im = internal->B_em[3];
  double n_Em_Rm = (internal->sigmaVer == 2 ? internal->B_em[1] + internal->B_em[2] : 0);
  double n_Em_Sm = (internal->sigmaVer == 1 ? internal->B_em[1] + internal->B_em[2] : 0);
  double n_En_Ej = internal->B_en[0];
  double n_En_Rn = (internal->sigmaVer == 2 ? internal->B_en[2] + internal->B_en[3] : 0);
  double n_En_Sn = (internal->sigmaVer == 1 ? internal->B_en[2] + internal->B_en[3] : 0);
  double n_If_Ef = internal->B_if[3];
  double n_If_Rf = (internal->gammaVer == 2 ? internal->B_if[1] + internal->B_if[2] : 0);
  double n_If_Sf = (internal->gammaVer == 1 ? internal->B_if[1] + internal->B_if[2] : 0);
  double n_Im_Em = internal->B_im[3];
  double n_Im_Rm = (internal->gammaVer == 2 ? internal->B_im[1] + internal->B_im[2] : 0);
  double n_Im_Sm = (internal->gammaVer == 1 ? internal->B_im[1] + internal->B_im[2] : 0);
  double n_Ma_Sj = internal->B_ma[0];
  double n_Rf_Sf = internal->B_rf[1];
  double n_Rj_RmRf = internal->B_rj[0];
  double n_Rj_Sj = internal->B_rj[2];
  double n_Rm_Sm = internal->B_rm[1];
  double n_Rn_Rj = internal->B_rn[0];
  double n_Rn_Sn = internal->B_rn[2];
  {
     int i = 1;
     internal->p[i - 1] = internal->P_matWane / (double) B_snSum;
  }
  {
     int i = 2;
     internal->p[i - 1] = P_death / (double) B_snSum;
  }
  {
     int i = 3;
     internal->p[i - 1] = P_toE / (double) B_snSum;
  }
  {
     int i = 4;
     internal->p[i - 1] = P_toI / (double) B_snSum;
  }
  {
     int i = 1;
     internal->pf[i - 1] = P_deathA / (double) B_sfSum;
  }
  {
     int i = 2;
     internal->pf[i - 1] = P_toE / (double) B_sfSum;
  }
  {
     int i = 3;
     internal->pf[i - 1] = P_toI / (double) B_sfSum;
  }
  {
     int i = 1;
     internal->pj[i - 1] = internal->P_J_A / (double) B_sjSum;
  }
  {
     int i = 2;
     internal->pj[i - 1] = P_death / (double) B_sjSum;
  }
  {
     int i = 3;
     internal->pj[i - 1] = P_toE / (double) B_sjSum;
  }
  {
     int i = 4;
     internal->pj[i - 1] = P_toI / (double) B_sjSum;
  }
  {
     int i = 1;
     internal->pm[i - 1] = P_deathA / (double) B_smSum;
  }
  {
     int i = 2;
     internal->pm[i - 1] = P_toE / (double) B_smSum;
  }
  {
     int i = 3;
     internal->pm[i - 1] = P_toI / (double) B_smSum;
  }
  double sumBef = (internal->B_ef[0] + internal->B_ef[1] + internal->B_ef[2] + internal->B_ef[3]);
  double sumBej = (internal->B_ej[0] + internal->B_ej[1] + internal->B_ej[2] + internal->B_ej[3]);
  double sumBem = (internal->B_em[0] + internal->B_em[1] + internal->B_em[2] + internal->B_em[3]);
  double sumBen = (internal->B_en[0] + internal->B_en[1] + internal->B_en[2] + internal->B_en[3]);
  double sumBif = (internal->B_if[0] + internal->B_if[1] + internal->B_if[2] + internal->B_if[3]);
  double sumBim = (internal->B_im[0] + internal->B_im[1] + internal->B_im[2] + internal->B_im[3]);
  double sumBms = (internal->B_ma[0] + internal->B_ma[1]);
  double sumBrf = (internal->B_rf[0] + internal->B_rf[1]);
  double sumBrj = (internal->B_rj[0] + internal->B_rj[1] + internal->B_rj[2]);
  double sumBrm = (internal->B_rm[0] + internal->B_rm[1]);
  double sumBrn = (internal->B_rn[0] + internal->B_rn[1] + internal->B_rn[2]);
  Rf_rmultinom(B_sfSumBIN, internal->pf, internal->dim_pf, internal->B_sf);
  Rf_rmultinom(B_sjSumBIN, internal->pj, internal->dim_pj, internal->B_sj);
  Rf_rmultinom(B_smSumBIN, internal->pm, internal->dim_pm, internal->B_sm);
  Rf_rmultinom(B_snSumBIN, internal->p, internal->dim_p, internal->B_sn);
  state_next[4] = ((Ma + MAB - sumBms) <= 0 ? 1 : (Ma + MAB - sumBms));
  state_next[14] = ((Rf - sumBrf + round(n_Rj_RmRf / (double) 2) + n_Ef_Rf + n_If_Rf) <= 0 ? 1 : (Rf - sumBrf + round(n_Rj_RmRf / (double) 2) + n_Ef_Rf + n_If_Rf));
  state_next[12] = ((Rj - sumBrj + n_Rn_Rj + n_Ej_Rj) <= 0 ? 1 : (Rj - sumBrj + n_Rn_Rj + n_Ej_Rj));
  state_next[13] = ((Rm - sumBrm + round(n_Rj_RmRf / (double) 2) + n_Em_Rm + n_Im_Rm) <= 0 ? 1 : (Rm - sumBrm + round(n_Rj_RmRf / (double) 2) + n_Em_Rm + n_Im_Rm));
  state_next[11] = ((Rn - sumBrn + n_En_Rn) <= 0 ? 1 : (Rn - sumBrn + n_En_Rn));
  double n_Sf_Ef = (internal->betaVer == 1 ? internal->B_sf[1] + internal->B_sf[2] : 0);
  double n_Sf_If = (internal->betaVer == 2 ? internal->B_sf[1] + internal->B_sf[2] : 0);
  double n_Sj_Ej = (internal->betaVer == 1 ? internal->B_sj[2] + internal->B_sj[3] : 0);
  double n_Sj_SmSf = internal->B_sj[0];
  double n_Sm_Em = (internal->betaVer == 1 ? internal->B_sm[1] + internal->B_sm[2] : 0);
  double n_Sm_Im = (internal->betaVer == 2 ? internal->B_sm[1] + internal->B_sm[2] : 0);
  double n_Sn_En = (internal->betaVer == 1 ? internal->B_sn[2] + internal->B_sn[3] : 0);
  double n_Sn_Sj = internal->B_sn[0];
  double sumBsf = (internal->B_sf[0] + internal->B_sf[1] + internal->B_sf[2]);
  double sumBsj = (internal->B_sj[0] + internal->B_sj[1] + internal->B_sj[2] + internal->B_sj[3]);
  double sumBsm = (internal->B_sm[0] + internal->B_sm[1] + internal->B_sm[2]);
  double sumBsn = (internal->B_sn[0] + internal->B_sn[1] + internal->B_sn[2] + internal->B_sn[3]);
  state_next[8] = ((Ef - sumBef + round(n_Ej_EmEf / (double) 2) + n_Sf_Ef + n_If_Ef) <= 0 ? 1 : (Ef - sumBef + round(n_Ej_EmEf / (double) 2) + n_Sf_Ef + n_If_Ef));
  state_next[6] = ((Ej - sumBej + n_En_Ej + n_Sj_Ej) <= 0 ? 1 : (Ej - sumBej + n_En_Ej + n_Sj_Ej));
  state_next[7] = ((Em - sumBem + round(n_Ej_EmEf / (double) 2) + n_Sm_Em + n_Im_Em) <= 0 ? 1 : (Em - sumBem + round(n_Ej_EmEf / (double) 2) + n_Sm_Em + n_Im_Em));
  state_next[5] = ((En - sumBen + n_Sn_En) <= 0 ? 1 : (En - sumBen + n_Sn_En));
  state_next[10] = ((If - sumBif + n_Sf_If + n_Ef_If) <= 0 ? 1 : (If - sumBif + n_Sf_If + n_Ef_If));
  state_next[9] = ((Im - sumBim + n_Sm_Im + n_Em_Im) <= 0 ? 1 : (Im - sumBim + n_Sm_Im + n_Em_Im));
  state_next[3] = ((Sf - sumBsf + round(n_Sj_SmSf / (double) 2) + n_Ef_Sf + n_If_Sf + n_Rf_Sf) <= 0 ? 1 : (Sf - sumBsf + round(n_Sj_SmSf / (double) 2) + n_Ef_Sf + n_If_Sf + n_Rf_Sf));
  state_next[1] = ((Sj - sumBsj + n_Sn_Sj + n_Ma_Sj + n_Ej_Sj + n_Rj_Sj) <= 0 ? 1 : (Sj - sumBsj + n_Sn_Sj + n_Ma_Sj + n_Ej_Sj + n_Rj_Sj));
  state_next[2] = ((Sm - sumBsm + round(n_Sj_SmSf / (double) 2) + n_Em_Sm + n_Im_Sm + n_Rm_Sm) <= 0 ? 1 : (Sm - sumBsm + round(n_Sj_SmSf / (double) 2) + n_Em_Sm + n_Im_Sm + n_Rm_Sm));
  state_next[0] = ((Sn + SNB - sumBsn + n_En_Sn + n_Rn_Sn) <= 0 ? 1 : (Sn + SNB - sumBsn + n_En_Sn + n_Rn_Sn));
}
void stochSEIRadInf_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  stochSEIRadInf_rhs((stochSEIRadInf_internal*)internal, step, state, state_next, output);
}
SEXP stochSEIRadInf_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  stochSEIRadInf_internal *internal = stochSEIRadInf_get_internal(internal_p, 1);
  double *output = NULL;
  GetRNGstate();
  stochSEIRadInf_rhs(internal, INTEGER(step)[0], REAL(state), REAL(state_next), output);
  PutRNGstate();
  UNPROTECT(1);
  return state_next;
}
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max) {
  double ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected a scalar numeric for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for %s", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_double(&ret, 1, min, max, name);
  return ret;
}
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max) {
  int ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for %d", name);
    }
    if (TYPEOF(el) == REALSXP) {
      double tmp = REAL(el)[0];
      if (fabs(tmp - round(tmp)) > 2e-8) {
        Rf_error("Expected '%s' to be integer-like", name);
      }
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_int(&ret, 1, min, max, name);
  return ret;
}
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values(SEXP value, double min, double max,
                           const char *name) {
  size_t len = (size_t)length(value);
  if (TYPEOF(value) == INTSXP) {
    user_check_values_int(INTEGER(value), len, min, max, name);
  } else {
    user_check_values_double(REAL(value), len, min, max, name);
  }
}
SEXP user_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if(strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
